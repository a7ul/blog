{"data":{"site":{"siteMetadata":{"title":"Blog","author":"Atul R"}},"markdownRemark":{"id":"5f9c65d7-94db-5286-b0a3-ee13f0fbcc69","excerpt":"Recently, Google security blog published an article  here  which states: Beginning in July 2018 with the release of Chrome 68, Chrome will‚Ä¶","html":"<p>Recently, Google security blog published an article <a href=\"https://security.googleblog.com/2018/02/a-secure-web-is-here-to-stay.html\">here</a> which states:</p>\n<blockquote>\n<p>Beginning in July 2018 with the release of Chrome 68, Chrome will mark all HTTP sites as ‚Äúnot secure‚Äù.</p>\n</blockquote>\n<p>Google has been pushing for HTTPS for sometime now. A blog post in 2014 <a href=\"https://webmasters.googleblog.com/2014/08/https-as-ranking-signal.html\">here</a> tells us that Google‚Äôs search engine ranks HTTPS websites over unsecure HTTP websites.</p>\n<p>While more and more websites and apps are becoming HTTPS enabled, we still develop these web apps on our local development environment over HTTP.\nSince web browsers behave slighlty differently when serving HTTPS and HTTP website, this can lead to few issues when we deploy to production.</p>\n<p>One such issue is mixed content because some of the resource might be loaded using HTTP on a HTTPS site.  <a href=\"https://developers.google.com/web/fundamentals/security/prevent-mixed-content/what-is-mixed-content\">More on mixed content here</a>\n\n  <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/active-mixed-content-errors-c8517488bc3abb7f78a5f5108757ac11-2188b.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n  \n  <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block; max-width:100% !important;; max-width: 586px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 75.25597269624573%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAIAAABr+ngCAAAACXBIWXMAAAsSAAALEgHS3X78AAACyklEQVQozyVSaW+jOADl//+f0WpnJ206ScDgA8xhMMQYCBCuJE3TNkC6ZT1a6enpyR/sd1ibg6A1zcYyS2BUlnnU9ca2m/2+iWOFI+ddkiiRe15iWYlhCAA6xrogeMsLbWyOB4yL3U4aRmpZuQK0Cl3nCIUYO7pODYMCwG2787zGNK+u+10Ui0Lfa1Oa1gidKZ1ZMDn2bJozdb6UZmzy/Ttj9zAcGXtzaGfbrU0Un9U552NZahPnpQlK08oNvQCg3G1LhMqQlYFf+v7B82rGlBAYSwAyXc8N45Wxi+/fskwbj8cK49LQS9MsICwhrDCqfv+udjvhOAxCDwCFxLaHIDgh1EE0S7mUh+V81r7jeMRo0vUHISOED4xnBB9JPHP+iMI55lMUzXF8dZwawSOEDeetlJfD4aOutWm/Ly3rAIBQTwEgdT1DKPM86bpSNew4igWlnJAMwsIwVMaPJPmIos9CtV3Xymq53dbAqAFQs7WW1W63FYQpIdw0Q8MIgZHapHfdBqGe4M8kuYv9v12nzXl+MsFViKkslyxbYv7NoyWTixB/sN8vebGk4kvs7zG/CzHG/BYE71U19Z2mSj8jdCGkV7d67oDgiTonmQ1FMeR5J+Upz4c0zXw/wVggJAkZkmSIotdMamquzLLkZiMUVGBgyO0mW6/l05MaJl2vs+1OuvTA2Dvn75736bpLni+qcGX7UR1f1QwYdQiptBeHDv+7sMzOJs12M/h+K8S9KFS1d9V8Kv58r6pa3t60sbP7cHcS1rC3zgnoY/2akanl45FNfTK20XRJp1tx7eImc9vUaSQdDn6Xu+8nod0uLPCeKfmbwL9s8pOSfzy68uiT46yp84zgL4xXBP2y8RNzVzb8kYTrS+9eejp+CO39NQndNQ9eZLwR4Ytgz4KtFSfhJg5emLMKnBWjq8h7PmQkF1ZbufebWL7q77n6D53dADQxLy9IAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n    >\n      <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;\"\n        alt=\"mixed-content\"\n        title=\"\"\n        src=\"/static/active-mixed-content-errors-c8517488bc3abb7f78a5f5108757ac11-2188b.png\"\n        srcset=\"/static/active-mixed-content-errors-c8517488bc3abb7f78a5f5108757ac11-98951.png 200w,\n/static/active-mixed-content-errors-c8517488bc3abb7f78a5f5108757ac11-0927d.png 400w,\n/static/active-mixed-content-errors-c8517488bc3abb7f78a5f5108757ac11-2188b.png 586w\"\n        sizes=\"(max-width: 586px) 100vw, 586px\"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </p>\n<p>Issues like these can be prevented by using HTTPS on development machine (localhost).\nAlso, enabling HTTPS on the development version would allow it to be much more closer to the production version of the web app and hence would allow you to catch those bugs which would only show up after you deploy. </p>\n<h2>Overview of SSL Certificate generation process</h2>\n<h2>Setup local HTTPS development environemt</h2>\n<p><em>PS: Although this guide is for linux and Mac OS, Windows users can run equivalent commands and achieve the same result.</em>   </p>\n<h3>Step 1: Creating a Certificate Signing Request</h3>\n<p>Certificate Signing Request (CSR) is a message or block of encoded text sent from an applicant to a Certificate Authority (CA) in order to apply for a SSL Certificate. CSR usually contains all the information that needs to be stored in the SSL Certificate such as the organization name, common name (domain name), locality, and country along with public key of the applicant.</p>\n<p>In short:  CSR = (Some Information for Certificate) + (Public Key of applicant) </p>\n<p>A certificate authority (CA) will use a CSR to create your SSL certificate.\nHence, we need a public key to proceed with generation of CSR, so lets create that first.</p>\n<p><strong>Creating the private/public key pair</strong> </p>\n<div class=\"gatsby-highlight\" data-language=\"bash\">\n      <pre class=\"language-bash\"><code class=\"language-bash\">openssl genrsa -des3 -out localdomain.secure.key 2048</code></pre>\n      </div>\n<p>Enter a password when prompted. I will be using password as ‚Äúpassword‚Äù for the sake of demo.\nThis will generate a file <code class=\"language-text\">localdomain.secure.key</code>. The generated <code class=\"language-text\">localdomain.secure.key</code> is a password protected container which has both private and public keys (essentially a key pair).</p>\n<p>For the ease of learning we will remove the password protection in the next step.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\">\n      <pre class=\"language-bash\"><code class=\"language-bash\">openssl rsa -in  localdomain.secure.key -out localdomain.insecure.key</code></pre>\n      </div>\n<p>This will generate a file <code class=\"language-text\">localdomain.insecure.key</code> which is essentially our key pair without password protection. <em>You can also continue using the password protected <code class=\"language-text\">localdomain.secure.key</code> in place of the <code class=\"language-text\">localdomain.insecure.key</code> only thing you will be asked to enter the password for each command.</em></p>\n<p><strong>Creating a Certificate Signing Request</strong></p>\n<p>We will be generating a CSR for <code class=\"language-text\">localhost</code>. To do so we will first create a configuration file which will have all the information that needs to be sent to the CA.</p>\n<p>Create a configuration file for our localhost domain (<code class=\"language-text\">localdomain.csr.cnf</code>):</p>\n<div class=\"gatsby-highlight\" data-language=\"text\">\n      <pre class=\"language-text\"><code class=\"language-text\">[req]\ndefault_bits = 2048\nprompt = no\ndefault_md = sha256\ndistinguished_name = dn\n\n[dn]\nC=IN\nST=SomeState\nL=SomeCity\nO=SomeOrganization\nOU=SomeUnit\nemailAddress=test@test.com\nCN = localhost</code></pre>\n      </div>\n<p>Now run the following command to generate a csr from our key and configuration file:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\">\n      <pre class=\"language-bash\"><code class=\"language-bash\">openssl req -new -sha256 -nodes -out localdomain.csr -key localdomain.insecure.key -config localdomain.csr.cnf</code></pre>\n      </div>\n<p>You should now get a <code class=\"language-text\">localdomain.csr</code> file which can be sent to a CA for generating the SSL certificates for your domain.<br/>\n<strong>For production servers</strong> send your CSR file to one of the CAs mentioned <a href=\"https://en.wikipedia.org/wiki/Certificate_authority\">here</a> <br/>\n<strong>For development purposes</strong> we will generate our own Root SSL Certificate (CA Certificate) and use that to generate SSL certificates from our CSR file.   </p>\n<h3>Step 2: Generating Root SSL Certificate (CA Certificate)</h3>\n<p><strong>Creating the public/private key pair</strong></p>\n<p>To generate a self-signed certificate we need a public key much like when we were generating a CSR. Hence, like before we generate a new key for our CA Certificate.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\">\n      <pre class=\"language-bash\"><code class=\"language-bash\">openssl genrsa -des3 -out rootca.secure.key 2048</code></pre>\n      </div>\n<p>Enter a password when prompted. I will be using password as ‚Äúpassword‚Äù for the sake of demo.\n\n  <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/1.rootkey-b0ab1e56046d0f6fa05008a5f66269cf-04515.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n  \n  <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block; max-width:100% !important;; max-width: 800px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 13.35149863760218%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAYAAACTWi8uAAAACXBIWXMAAAsSAAALEgHS3X78AAAAYElEQVQI15WOSQqAMBAEhyTkkg2XSQYUxJvL/9/XwngV0UPRpy6KpHRoMaBJhYiAmVFr1U0pIsabnDOstSCid1gaSj/AGAvvveKc+3Z+Yl9WbPOE49y1innUmhCCyv8KLw5JQPHjxCbrAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n    >\n      <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;\"\n        alt=\"root_key_generation\"\n        title=\"\"\n        src=\"/static/1.rootkey-b0ab1e56046d0f6fa05008a5f66269cf-d256b.png\"\n        srcset=\"/static/1.rootkey-b0ab1e56046d0f6fa05008a5f66269cf-1aa72.png 200w,\n/static/1.rootkey-b0ab1e56046d0f6fa05008a5f66269cf-76ac4.png 400w,\n/static/1.rootkey-b0ab1e56046d0f6fa05008a5f66269cf-d256b.png 800w,\n/static/1.rootkey-b0ab1e56046d0f6fa05008a5f66269cf-04515.png 1101w\"\n        sizes=\"(max-width: 800px) 100vw, 800px\"\n      />\n    </span>\n  </span>\n  \n  </a>\n    \nThis will generate a file <code class=\"language-text\">rootca.secure.key</code>. The generated <code class=\"language-text\">rootca.secure.key</code> is a password protected container which has both private and public keys (essentially a key pair).</p>\n<p>For the ease of learning we will remove the password protection in the next step.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\">\n      <pre class=\"language-bash\"><code class=\"language-bash\">openssl rsa -in rootca.secure.key -out rootca.insecure.key</code></pre>\n      </div>\n<p>\n  <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/2.unsecure_rootkey-25074d2fad39fd6202065adf1a56dad4-4167e.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n  \n  <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block; max-width:100% !important;; max-width: 800px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 10.869565217391305%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAACCAYAAABYBvyLAAAACXBIWXMAAAsSAAALEgHS3X78AAAAXElEQVQI143KOQ6AIBAFUCoMgjPDEjAWSLj/Hb+IJrYWr/iLspGhfQT7hH1ZQKtBzgkhRBDRJMzgl3UO23B3NIgI3MhKqUfrDUetOFtHHmMQRikZxph51Fp/5x8udwgtCRmTYoAAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n    >\n      <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;\"\n        alt=\"unsecure_rootkey\"\n        title=\"\"\n        src=\"/static/2.unsecure_rootkey-25074d2fad39fd6202065adf1a56dad4-d256b.png\"\n        srcset=\"/static/2.unsecure_rootkey-25074d2fad39fd6202065adf1a56dad4-1aa72.png 200w,\n/static/2.unsecure_rootkey-25074d2fad39fd6202065adf1a56dad4-76ac4.png 400w,\n/static/2.unsecure_rootkey-25074d2fad39fd6202065adf1a56dad4-d256b.png 800w,\n/static/2.unsecure_rootkey-25074d2fad39fd6202065adf1a56dad4-4167e.png 828w\"\n        sizes=\"(max-width: 800px) 100vw, 800px\"\n      />\n    </span>\n  </span>\n  \n  </a>\n    \nThis will generate a file <code class=\"language-text\">rootca.insecure.key</code> which is essentially our key pair without password protection. <em>You can also continue using the password protected <code class=\"language-text\">rootca.secure.key</code> in place of the <code class=\"language-text\">rootca.insecure.key</code> only thing you will be asked to enter the password for each command.</em></p>\n<p><em>PS: Please do not use unsecure keys when generating certificates for production use. Issue with using unsecure key is that if you accidentally expose the key, all your certifiactes and services will also be vulnerable. But since we are using it for development purpose at this time. Lets go ahead and use unsecure keys.</em></p>\n<p><strong>Generating Root SSL Certificate (CA Certificate)</strong></p>\n<p>Run the following command:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\">\n      <pre class=\"language-bash\"><code class=\"language-bash\">openssl req -new -x509 -nodes -key rootca.insecure.key -sha256 -out cacert.pem -days 3650</code></pre>\n      </div>\n<p>\n  <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/3.generate_root_ssl_cert-7040fce7b3330c8a12a1d8d40cc6da52-9f9f2.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n  \n  <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block; max-width:100% !important;; max-width: 800px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 30.19047619047619%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAAsSAAALEgHS3X78AAAA30lEQVQY042QW2+EIBCF0XiJF9aoKKICCu5usun//3unDGmavnTbh5MZIPPNOTAuenRyheQ3LH2HWUr0fR81juOPXkCGt67rUFUV2rb9rnVd48Y58jwH86eDNQanczD2gLU2DgohMM8zpmmKZx4GaLAoCjDGfte2bViDxmGIg8uygO6oJ2CWZXFzkqZIkgRpqG+BWmvsu8aqFFTQHmAmOKZoFIdUlmUEEfAtjPTxeuH5eMBdPsT2uLzH/bpAiwhMjgnaNE10+ydQnRrK3aEHgedhcJxHjEgfTs5I/3L2pU9HuImNNuKGMAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n    >\n      <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;\"\n        alt=\"generate_root_ssl\"\n        title=\"\"\n        src=\"/static/3.generate_root_ssl_cert-7040fce7b3330c8a12a1d8d40cc6da52-d256b.png\"\n        srcset=\"/static/3.generate_root_ssl_cert-7040fce7b3330c8a12a1d8d40cc6da52-1aa72.png 200w,\n/static/3.generate_root_ssl_cert-7040fce7b3330c8a12a1d8d40cc6da52-76ac4.png 400w,\n/static/3.generate_root_ssl_cert-7040fce7b3330c8a12a1d8d40cc6da52-d256b.png 800w,\n/static/3.generate_root_ssl_cert-7040fce7b3330c8a12a1d8d40cc6da52-9f9f2.png 1050w\"\n        sizes=\"(max-width: 800px) 100vw, 800px\"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </p>\n<p>Enter all the information that is asked. I filled in all dummy values for now.<br/>\nThis will generate <code class=\"language-text\">cacert.pem</code> which is our Root SSL Certificate (CA). We will use <code class=\"language-text\">cacert.pem</code> along with <code class=\"language-text\">localdomain.csr</code>(our CSR file) to generate the required SSL Certificate for localhost.</p>\n<h3>Step 3: Generating SSL Certificate for localhost</h3>\n<p>To create our localhost SSL certificate we will now create another configuration file <code class=\"language-text\">localdomain.v3.ext</code></p>\n<div class=\"gatsby-highlight\" data-language=\"text\">\n      <pre class=\"language-text\"><code class=\"language-text\">authorityKeyIdentifier=keyid,issuer\nbasicConstraints=CA:FALSE\nkeyUsage = digitalSignature, nonRepudiation, keyEncipherment, dataEncipherment\nsubjectAltName = @alt_names\n\n[alt_names]\nDNS.1 = localhost</code></pre>\n      </div>\n<p>We need to specify subhectAltName with the domain <code class=\"language-text\">localhost</code> as shown.</p>\n<p>Finally, we will now use our CSR(<code class=\"language-text\">localdomain.csr</code>) + CA Certificate(<code class=\"language-text\">cacert.pem</code>) + CA Key + (<code class=\"language-text\">rootca.insecure.key</code>) + Configuration file(<code class=\"language-text\">localdomain.v3.ext</code>) to generate our <code class=\"language-text\">localdomain.crt</code></p>\n<p>Now run the command</p>\n<div class=\"gatsby-highlight\" data-language=\"text\">\n      <pre class=\"language-text\"><code class=\"language-text\">openssl x509 -req -in localdomain.csr -CA cacert.pem -CAkey rootca.insecure.key -CAcreateserial -out localdomain.crt -days 500 -sha256 -extfile localdomain.v3.ext</code></pre>\n      </div>\n<p>\n  <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/5.generate_domain_certificate-1f062807c8724c9e3dd407438f5a391c-4750e.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n  \n  <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block; max-width:100% !important;; max-width: 800px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 15.723270440251572%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAYAAACTWi8uAAAACXBIWXMAAAsSAAALEgHS3X78AAAAlklEQVQI12WNzQrCMBCEkzZpmp9Gk9SE0h5ExIJ3+/5vNiYrguBhmN39Zlh2fdwRlhXFn1CCRy4ZOWeklEjbtiGmCO89rLVwrsnRPE0TjDG0N661BjteB+YYoGtQWwdXg1JKKiilqPANt3vzYRiICyGJj+NYZ0F5dnvuMPGCxZ+xzgGufmWMoes6cM7Jf9X3/Z83cf7hbw8pRADwUONgAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n    >\n      <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;\"\n        alt=\"generate_domain_cert\"\n        title=\"\"\n        src=\"/static/5.generate_domain_certificate-1f062807c8724c9e3dd407438f5a391c-d256b.png\"\n        srcset=\"/static/5.generate_domain_certificate-1f062807c8724c9e3dd407438f5a391c-1aa72.png 200w,\n/static/5.generate_domain_certificate-1f062807c8724c9e3dd407438f5a391c-76ac4.png 400w,\n/static/5.generate_domain_certificate-1f062807c8724c9e3dd407438f5a391c-d256b.png 800w,\n/static/5.generate_domain_certificate-1f062807c8724c9e3dd407438f5a391c-4750e.png 1113w\"\n        sizes=\"(max-width: 800px) 100vw, 800px\"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </p>\n<p>If you check your directory now you will see a lot of files. Important files now to keep for next step are:</p>\n<ul>\n<li>CA/Root SSL Certificate: <strong>cacert.pem</strong></li>\n<li>Domain Certificate: <strong>localdomain.crt</strong></li>\n<li>Domain Key: <strong>localdomain.insecure.key</strong></li>\n</ul>\n<h2>How to use the SSL Certificates?</h2>\n<h3>Using the certificates in a NodeJS backend locally</h3>\n<p><code class=\"language-text\">index.js</code></p>\n<div class=\"gatsby-highlight\" data-language=\"js\">\n      <pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">const</span> https <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"https\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> \n<span class=\"token keyword\">const</span> fs <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'fs'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> path <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'path'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> port <span class=\"token operator\">=</span> <span class=\"token number\">3000</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> certOptions <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  key<span class=\"token punctuation\">:</span> fs<span class=\"token punctuation\">.</span><span class=\"token function\">readFileSync</span><span class=\"token punctuation\">(</span>path<span class=\"token punctuation\">.</span><span class=\"token function\">resolve</span><span class=\"token punctuation\">(</span><span class=\"token string\">'../localdomain.insecure.key'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n  cert<span class=\"token punctuation\">:</span> fs<span class=\"token punctuation\">.</span><span class=\"token function\">readFileSync</span><span class=\"token punctuation\">(</span>path<span class=\"token punctuation\">.</span><span class=\"token function\">resolve</span><span class=\"token punctuation\">(</span><span class=\"token string\">'../localdomain.crt'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n  \nhttps<span class=\"token punctuation\">.</span><span class=\"token function\">createServer</span><span class=\"token punctuation\">(</span>certOptions<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span>reqst<span class=\"token punctuation\">,</span> resp<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span> \n    resp<span class=\"token punctuation\">.</span><span class=\"token function\">writeHead</span><span class=\"token punctuation\">(</span><span class=\"token number\">200</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span><span class=\"token string\">'Content-Type'</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'text/plain'</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> \n    resp<span class=\"token punctuation\">.</span><span class=\"token function\">end</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Hello World Node!'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> \n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">listen</span><span class=\"token punctuation\">(</span>port<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> \n\nconsole<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Load https://localhost:'</span> <span class=\"token operator\">+</span> port<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre>\n      </div>\n<p>After this run <code class=\"language-text\">node index.js</code> and server should be running at\n<a href=\"https://localhost:3000\">https://localhost:3000</a></p>\n<h3>Using the certificates for a frontend only application</h3>\n<p>When developing frontend application we often use a development server to run the application and then access it via <code class=\"language-text\">localhost:xxxx</code>.\nOne such development server is <code class=\"language-text\">http-server</code> npm module.</p>\n<div class=\"gatsby-highlight\" data-language=\"sh\">\n      <pre class=\"language-sh\"><code class=\"language-sh\">mkdir project\ncd project\nnpm install -g http-server\necho &quot;Hello World&quot; &gt; index.html\nhttp-server -a localhost --ssl --cert &lt;path to&gt;/localdomain.crt --key &lt;path to&gt;/localdomain.insecure.key</code></pre>\n      </div>\n<p>\n  <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/7.http_server_with_ssl-544f7238ed377329033f92ed93882d06-4750e.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n  \n  <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block; max-width:100% !important;; max-width: 800px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 17.07097933513028%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAYAAACTWi8uAAAACXBIWXMAAAsSAAALEgHS3X78AAAAcklEQVQI15WNQQ7CMAwEDYfEcWyniVuKBEj8/5NLFIkH9DCH0Wp3yQ+BnR2hGb3c0bvATbA1hsdAyhl5IiKotcLdl3Mpy80MqrryMQbo+w58nhte54EIRSkJRITbhC6S0uxaa5DWsSfGY76q6eWhP8yMHzLDQKkHm346AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n    >\n      <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;\"\n        alt=\"chrome_http_server\"\n        title=\"\"\n        src=\"/static/7.http_server_with_ssl-544f7238ed377329033f92ed93882d06-d256b.png\"\n        srcset=\"/static/7.http_server_with_ssl-544f7238ed377329033f92ed93882d06-1aa72.png 200w,\n/static/7.http_server_with_ssl-544f7238ed377329033f92ed93882d06-76ac4.png 400w,\n/static/7.http_server_with_ssl-544f7238ed377329033f92ed93882d06-d256b.png 800w,\n/static/7.http_server_with_ssl-544f7238ed377329033f92ed93882d06-4750e.png 1113w\"\n        sizes=\"(max-width: 800px) 100vw, 800px\"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </p>\n<p>This runs the hello world index.html website in ssl mode in dev server.\nNow open up <a href=\"https://localhost:8080\">https://localhost:8080</a>.</p>\n<hr>\n<h3>Importing development SSL Certificates to the Browsers</h3>\n<p>Now if you open up the website at <code class=\"language-text\">https://localhost:xxxx</code> on Google Chrome or Firefox you should see an error message like this:</p>\n<p>\n  <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/browser_err_invalid_cert_authority-c40400e814c2d489f5b38eed7dda040f-8c33e.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n  \n  <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block; max-width:100% !important;; max-width: 800px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 37.108559498956154%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAAsSAAALEgHS3X78AAAAuklEQVQoz62QSwrCMBiEe/8TVVus2lVdeASx6qZISV8074xJqxCtWQj+YUhgJl+YRLfrBW1d43gokCYr5PkO+X77k7JkjTiNsclSRPjzRMYYuKW1tlJQSkFbQzQNWFlOZyXl05/lMr58bwZ+yI3kHHVVgVgwIQQjpeBcQEo1+d/uOS0qv4DutX4Y0HUdBrs7mGtgE2+5ReUQ0FggY2wSpcxWk+hHgfNdQKgwNAw087/601KD4iQw8jDwAcWbHKC3uxUpAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n    >\n      <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;\"\n        alt=\"err_invalid_cert_authority\"\n        title=\"\"\n        src=\"/static/browser_err_invalid_cert_authority-c40400e814c2d489f5b38eed7dda040f-d256b.png\"\n        srcset=\"/static/browser_err_invalid_cert_authority-c40400e814c2d489f5b38eed7dda040f-1aa72.png 200w,\n/static/browser_err_invalid_cert_authority-c40400e814c2d489f5b38eed7dda040f-76ac4.png 400w,\n/static/browser_err_invalid_cert_authority-c40400e814c2d489f5b38eed7dda040f-d256b.png 800w,\n/static/browser_err_invalid_cert_authority-c40400e814c2d489f5b38eed7dda040f-c8b46.png 1200w,\n/static/browser_err_invalid_cert_authority-c40400e814c2d489f5b38eed7dda040f-3488d.png 1600w,\n/static/browser_err_invalid_cert_authority-c40400e814c2d489f5b38eed7dda040f-8c33e.png 1916w\"\n        sizes=\"(max-width: 800px) 100vw, 800px\"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </p>\n<p>The error is <code class=\"language-text\">NET::ERR_CERT_AUTHORITY_INVALID</code>. It means the browser is not able to trust the CA which issued this SSL certificate.\nHence to make our browser trust our own self signed CA Certificate (<code class=\"language-text\">cacert.pem</code>) we need to do the following:</p>\n<p>We need both localdomain.insecure.key and localdomain.crt to import the crt to browsers.\nHence, We will combine them to generate a pfx file. Which is basically a container containing both certificate and the key.\nThis will help us import it into browsers smoothly.\nSo to do that\nopenssl pkcs12 -export -out localdomain.pfx -inkey localdomain.insecure.key -in localdomain.crt</p>\n<p>// IMPORT TO CHROME</p>\n<p>ONE: Type in url bar of chrome and press enter.\nchrome://settings/certificates</p>\n<p>TWO: Now go to the tab ‚ÄúAuthorities‚Äù\nWe will import our CA (cacert.pem) into this.\nClick on import\nCheck the Trust this certificate for identifying websites checkbox and press OK.\n(If you scroll through the CA list you should see our CA at org-Testing or whatever you entered while generating it)</p>\n<p>THREE: Import the domain certificates\nNow go to ‚ÄúYour Certifiactes Tab‚Äù\nClick on import\nAnd choose localdomain.pfx file.\nIf it asks for password enter the export password you used while creating the pfx</p>\n<p>//IMPORT TO FIREFOX\n6.</p>\n<p>ONE: Type in url bar of firefox and press enter.\nabout:preferences#privacy\nNow scroll down to Certifiactes(under security)\nand click on ‚ÄúView Certifiactes‚Äù</p>\n<p>TWO: Now go to the tab ‚ÄúAuthorities‚Äù\nWe will import our CA (cacert.pem) into this.\nClick on import\nCheck the ‚ÄúTrust this CA  to identifying websites‚Äù checkbox and press OK.\n(If you scroll through the CA list you should see our CA at org-Testing or whatever you entered while generating it)</p>\n<p>THREE: Import the domain certificates\nNow go to ‚ÄúYour Certifiactes Tab‚Äù\nClick on import\nAnd choose localdomain.pfx file.\nIf it asks for password enter the export password you used while creating the pfx</p>\n<p>Keep in mind use these certificates only for development.\nThese wont work in production as the certificate authority will not be trusted in your users browsers.\nFor production. generate a csr and then send it you CA and CA will generate a domain certificate for you.</p>\n<h2>References</h2>\n<ul>\n<li><a href=\"https://security.googleblog.com/2018/02/a-secure-web-is-here-to-stay.html\">https://security.googleblog.com/2018/02/a-secure-web-is-here-to-stay.html</a></li>\n<li><a href=\"https://support.google.com/webmasters/answer/6073543?hl=en\">https://support.google.com/webmasters/answer/6073543?hl=en</a></li>\n<li><a href=\"https://webmasters.googleblog.com/2014/08/https-as-ranking-signal.html\">https://webmasters.googleblog.com/2014/08/https-as-ranking-signal.html</a></li>\n<li><a href=\"https://www.theregister.co.uk/2018/02/08/google_chrome_http_shame/\">https://www.theregister.co.uk/2018/02/08/google<em>chrome</em>http_shame/</a></li>\n<li><a href=\"https://help.ubuntu.com/lts/serverguide/certificates-and-security.html.en-GB\">https://help.ubuntu.com/lts/serverguide/certificates-and-security.html.en-GB</a></li>\n<li><a href=\"https://medium.freecodecamp.org/how-to-get-https-working-on-your-local-development-environment-in-5-minutes-7af615770eec\">https://medium.freecodecamp.org/how-to-get-https-working-on-your-local-development-environment-in-5-minutes-7af615770eec</a></li>\n<li><a href=\"https://www.sslshopper.com/what-is-a-csr-certificate-signing-request.html\">https://www.sslshopper.com/what-is-a-csr-certificate-signing-request.html</a></li>\n</ul>","frontmatter":{"title":"üîê HTTPS certificate generation explained! Now setup HTTPS for local development environment (without sudo)","date":"August 04, 2018"},"fields":{"slug":"/localhost-https/"}}},"pageContext":{"slug":"/localhost-https/","previous":null,"next":null}}