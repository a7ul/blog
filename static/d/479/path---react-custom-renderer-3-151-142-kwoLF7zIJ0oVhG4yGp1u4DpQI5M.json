{"data":{"site":{"siteMetadata":{"title":"Blog","author":"Atul R"}},"markdownRemark":{"id":"1012725f-a0a8-5612-ad0c-3df421b5f78a","excerpt":"This is the third post of 3 post series on Custom React Renderers.This post will cover  the update phase of the renderer . I strongly‚Ä¶","html":"<hr>\n<p>This is the third post of 3 post series on Custom React Renderers.This post will cover <strong>the update phase of the renderer</strong>.</p>\n<p>I strongly recommend you to read earlier posts before reading this post.</p>\n<ul>\n<li><a href='/react-custom-renderer-1/' target='_blank'>‚öõÔ∏èüëÜ Part 1/3 - Beginners guide to Custom React Renderers‚Ä¶</a> and</li>\n<li><a href='/react-custom-renderer-2/' target='_blank'>‚öõÔ∏è‚úåÔ∏è Part 2/3 - Beginners guide to Custom React Renderers‚Ä¶</a>.</li>\n</ul>\n<hr>\n<p>At this point we have a custom react renderer that can render our react app into the DOM tree.</p>\n<p>Our HostConfig looks like this now:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">const</span> HostConfig <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  now<span class=\"token punctuation\">:</span> Date<span class=\"token punctuation\">.</span>now<span class=\"token punctuation\">,</span>\n  getRootHostContext<span class=\"token punctuation\">:</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span>nextRootInstance<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">let</span> rootContext <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\n    <span class=\"token keyword\">return</span> rootContext\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  getChildHostContext<span class=\"token punctuation\">:</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span>parentContext<span class=\"token punctuation\">,</span> fiberType<span class=\"token punctuation\">,</span> rootInstance<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">let</span> context <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span> type<span class=\"token punctuation\">:</span> fiberType <span class=\"token punctuation\">}</span>\n    <span class=\"token keyword\">return</span> context\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  shouldSetTextContent<span class=\"token punctuation\">:</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span>type<span class=\"token punctuation\">,</span> nextProps<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token boolean\">false</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  createTextInstance<span class=\"token punctuation\">:</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span>\n    newText<span class=\"token punctuation\">,</span>\n    rootContainerInstance<span class=\"token punctuation\">,</span>\n    currentHostContext<span class=\"token punctuation\">,</span>\n    workInProgress\n  <span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">createTextNode</span><span class=\"token punctuation\">(</span>newText<span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  createInstance<span class=\"token punctuation\">:</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span>\n    type<span class=\"token punctuation\">,</span>\n    newProps<span class=\"token punctuation\">,</span>\n    rootContainerInstance<span class=\"token punctuation\">,</span>\n    currentHostContext<span class=\"token punctuation\">,</span>\n    workInProgress\n  <span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> element <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">createElement</span><span class=\"token punctuation\">(</span>type<span class=\"token punctuation\">)</span>\n    element<span class=\"token punctuation\">.</span>className <span class=\"token operator\">=</span> newProps<span class=\"token punctuation\">.</span>className <span class=\"token operator\">||</span> <span class=\"token string\">''</span>\n    element<span class=\"token punctuation\">.</span>style <span class=\"token operator\">=</span> newProps<span class=\"token punctuation\">.</span>style\n    <span class=\"token comment\">// ....</span>\n    <span class=\"token comment\">// ....</span>\n    <span class=\"token comment\">// if (newProps.onClick) {</span>\n    <span class=\"token comment\">//   element.addEventListener('click', newProps.onClick)</span>\n    <span class=\"token comment\">// }</span>\n    <span class=\"token keyword\">return</span> element\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  appendInitialChild<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">(</span>parent<span class=\"token punctuation\">,</span> child<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    parent<span class=\"token punctuation\">.</span><span class=\"token function\">appendChild</span><span class=\"token punctuation\">(</span>child<span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  finalizeInitialChildren<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">(</span>\n    instance<span class=\"token punctuation\">,</span>\n    type<span class=\"token punctuation\">,</span>\n    newProps<span class=\"token punctuation\">,</span>\n    rootContainerInstance<span class=\"token punctuation\">,</span>\n    currentHostContext\n  <span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> newProps<span class=\"token punctuation\">.</span>autofocus <span class=\"token comment\">//simply return true for experimenting</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  prepareForCommit<span class=\"token punctuation\">:</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span>rootContainerInstance<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  resetAfterCommit<span class=\"token punctuation\">:</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span>rootContainerInstance<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  commitMount<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">(</span>domElement<span class=\"token punctuation\">,</span> type<span class=\"token punctuation\">,</span> newProps<span class=\"token punctuation\">,</span> fiberNode<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    domElement<span class=\"token punctuation\">.</span><span class=\"token function\">focus</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  appendChildToContainer<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">(</span>parent<span class=\"token punctuation\">,</span> child<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    parent<span class=\"token punctuation\">.</span><span class=\"token function\">appendChild</span><span class=\"token punctuation\">(</span>child<span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  supportsMutation<span class=\"token punctuation\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>and this is our App code.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">import</span> React <span class=\"token keyword\">from</span> <span class=\"token string\">'react'</span>\n<span class=\"token comment\">// import ReactDOM from \"react-dom\";</span>\n<span class=\"token keyword\">import</span> CustomRenderer <span class=\"token keyword\">from</span> <span class=\"token string\">'./renderer'</span>\n\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">Text</span> <span class=\"token operator\">=</span> props <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token operator\">&lt;</span>p className<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>props<span class=\"token punctuation\">.</span>className<span class=\"token punctuation\">}</span><span class=\"token operator\">></span><span class=\"token punctuation\">{</span>props<span class=\"token punctuation\">.</span>content<span class=\"token punctuation\">}</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>p<span class=\"token operator\">></span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">App</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token operator\">&lt;</span>div<span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span>Text className<span class=\"token operator\">=</span><span class=\"token string\">\"hello-class\"</span> content<span class=\"token operator\">=</span><span class=\"token string\">\"Hello\"</span> <span class=\"token operator\">/</span><span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span>span style<span class=\"token operator\">=</span><span class=\"token string\">\"color:blue;\"</span> autofocus<span class=\"token operator\">></span>\n        World\n      <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>span<span class=\"token operator\">></span>\n    <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span>\n  <span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\">// ReactDOM.render(&lt;App />, document.getElementById(\"root\"));</span>\nCustomRenderer<span class=\"token punctuation\">.</span><span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token operator\">&lt;</span>App <span class=\"token operator\">/</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">getElementById</span><span class=\"token punctuation\">(</span><span class=\"token string\">'root'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>Now lets add state to our app and use a button to change the state on click and see what happens.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">import</span> React <span class=\"token keyword\">from</span> <span class=\"token string\">'react'</span>\n<span class=\"token comment\">// import ReactDOM from \"react-dom\";</span>\n<span class=\"token keyword\">import</span> CustomRenderer <span class=\"token keyword\">from</span> <span class=\"token string\">'./renderer'</span>\n\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">Text</span> <span class=\"token operator\">=</span> props <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token operator\">&lt;</span>p className<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>props<span class=\"token punctuation\">.</span>className<span class=\"token punctuation\">}</span><span class=\"token operator\">></span><span class=\"token punctuation\">{</span>props<span class=\"token punctuation\">.</span>content<span class=\"token punctuation\">}</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>p<span class=\"token operator\">></span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">App</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">React<span class=\"token punctuation\">.</span>Component</span> <span class=\"token punctuation\">{</span>\n  state <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n    text<span class=\"token punctuation\">:</span> Date<span class=\"token punctuation\">.</span><span class=\"token function\">now</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token function-variable function\">onButtonClick</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">setState</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> text<span class=\"token punctuation\">:</span> Date<span class=\"token punctuation\">.</span><span class=\"token function\">now</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n      <span class=\"token operator\">&lt;</span>div<span class=\"token operator\">></span>\n        <span class=\"token operator\">&lt;</span>Text className<span class=\"token operator\">=</span><span class=\"token string\">\"hello-class\"</span> content<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">.</span>text<span class=\"token punctuation\">}</span> <span class=\"token operator\">/</span><span class=\"token operator\">></span>\n        <span class=\"token operator\">&lt;</span>span style<span class=\"token operator\">=</span><span class=\"token string\">\"color:blue;\"</span> autofocus<span class=\"token operator\">></span>\n          World\n        <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>span<span class=\"token operator\">></span>\n        <span class=\"token operator\">&lt;</span>button onClick<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>onButtonClick<span class=\"token punctuation\">}</span><span class=\"token operator\">></span>Get current time<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>button<span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span>\n    <span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\">// ReactDOM.render(&lt;App />, document.getElementById(\"root\"));</span>\nCustomRenderer<span class=\"token punctuation\">.</span><span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token operator\">&lt;</span>App <span class=\"token operator\">/</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">getElementById</span><span class=\"token punctuation\">(</span><span class=\"token string\">'root'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>Now, you should see a button like this:\n\n  <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/added_btn-f2df0b7e492592a3cb4aa9700e372623-2858f.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n  \n  <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block; max-width:100% !important;; max-width: 800px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 30.139103554868623%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAXklEQVQY062P2wqAIBAF9/8/UrpIaBIkVqbFnjIogt60eVw4wyxZO8AYDa0UwuqRYGbkQrKNENUI0XSoZQ87hUeaI6YYgdkz3LJdMh/2MuE5/RyLXk7bu+ZdVVD4LwfdK9uPNwo+wgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n    >\n      <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;\"\n        alt=\"added a new button\"\n        title=\"\"\n        src=\"/static/added_btn-f2df0b7e492592a3cb4aa9700e372623-d256b.png\"\n        srcset=\"/static/added_btn-f2df0b7e492592a3cb4aa9700e372623-1aa72.png 200w,\n/static/added_btn-f2df0b7e492592a3cb4aa9700e372623-76ac4.png 400w,\n/static/added_btn-f2df0b7e492592a3cb4aa9700e372623-d256b.png 800w,\n/static/added_btn-f2df0b7e492592a3cb4aa9700e372623-c8b46.png 1200w,\n/static/added_btn-f2df0b7e492592a3cb4aa9700e372623-2858f.png 1294w\"\n        sizes=\"(max-width: 800px) 100vw, 800px\"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </p>\n<p>When you try and click on the button, we see that nothing happens. This is happening because our onClick listener is not getting invoked. And the reason why this happens is because our renderer doesnt know what to do with <strong>onClick</strong> prop on the button.\nLets add that functionality to our <strong>hostConfig</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token operator\">...</span>\n<span class=\"token operator\">...</span>\n<span class=\"token operator\">...</span>\ncreateInstance<span class=\"token punctuation\">:</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span>\n    type<span class=\"token punctuation\">,</span>\n    newProps<span class=\"token punctuation\">,</span>\n    rootContainerInstance<span class=\"token punctuation\">,</span>\n    currentHostContext<span class=\"token punctuation\">,</span>\n    workInProgress\n  <span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> element <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">createElement</span><span class=\"token punctuation\">(</span>type<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    element<span class=\"token punctuation\">.</span>className <span class=\"token operator\">=</span> newProps<span class=\"token punctuation\">.</span>className <span class=\"token operator\">||</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">;</span>\n    element<span class=\"token punctuation\">.</span>style <span class=\"token operator\">=</span> newProps<span class=\"token punctuation\">.</span>style<span class=\"token punctuation\">;</span>\n    <span class=\"token comment\">// ....</span>\n    <span class=\"token comment\">// ....</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>newProps<span class=\"token punctuation\">.</span>onClick<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      element<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"click\"</span><span class=\"token punctuation\">,</span> newProps<span class=\"token punctuation\">.</span>onClick<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token keyword\">return</span> element<span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n<span class=\"token operator\">...</span>\n<span class=\"token operator\">...</span>\n<span class=\"token operator\">...</span></code></pre></div>\n<p>Refresh and click on the button. Boom! we get an error.</p>\n<p>\n  <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/prepareUpdate-cd6f8e5456f10ce3ef8c25c944b7aaed-2d94c.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n  \n  <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block; max-width:100% !important;; max-width: 800px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 24.58536585365854%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAABYlAAAWJQFJUiTwAAAA3ElEQVQY04WQyXKDMBBE+f9vS07k5CrbLAlCAglhLZi10+jA1ap61T1TGs1oslkbxLLGW3aY/xosv6RVWM2ARcik5zmO4yPbviPzzkFJiV51cHZEZDz5kIjOY54m7NuKg5dZ9ZEsaA11u6G736HIUNdwQsA1Ap7q25baYu41toFT80ebMZzc0OtLkyeZbyXE1zdk/gOR57BFCVMU0M8nXnz8jAfGJ/rxgC2rlB+rir5E4JomNo5Nk8ii9+g5xYvdX9yX7Xo4qlEKwVrmNMa+v1hCSMysW2MgEViWi3+5QH39diUjFgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n    >\n      <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;\"\n        alt=\"prepareUpdate error\"\n        title=\"\"\n        src=\"/static/prepareUpdate-cd6f8e5456f10ce3ef8c25c944b7aaed-d256b.png\"\n        srcset=\"/static/prepareUpdate-cd6f8e5456f10ce3ef8c25c944b7aaed-1aa72.png 200w,\n/static/prepareUpdate-cd6f8e5456f10ce3ef8c25c944b7aaed-76ac4.png 400w,\n/static/prepareUpdate-cd6f8e5456f10ce3ef8c25c944b7aaed-d256b.png 800w,\n/static/prepareUpdate-cd6f8e5456f10ce3ef8c25c944b7aaed-c8b46.png 1200w,\n/static/prepareUpdate-cd6f8e5456f10ce3ef8c25c944b7aaed-3488d.png 1600w,\n/static/prepareUpdate-cd6f8e5456f10ce3ef8c25c944b7aaed-2d94c.png 2050w\"\n        sizes=\"(max-width: 800px) 100vw, 800px\"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </p>\n<p>Well ü§∑üèª‚Äç atleast it means that our <strong>onClick</strong> listener is now working. Lets stub this method in our hostConfig.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token operator\">...</span>\n  prepareUpdate<span class=\"token punctuation\">:</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token operator\">...</span>args<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"prepareUpdate\"</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">...</span>args<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token operator\">...</span></code></pre></div>\n<p>We get another error related to <strong>commitTextUpdate</strong> now. Lets stub that too.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token operator\">...</span>\n commitTextUpdate<span class=\"token punctuation\">:</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token operator\">...</span>args<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"commitTextUpdate\"</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">...</span>args<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token operator\">...</span></code></pre></div>\n<p>No more errors! Now, lets take a look at their respective implementations.</p>\n<h3>‚ñ∏ prepareUpdate</h3>\n<hr>\n<p>The function signature is:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">function</span> <span class=\"token function\">prepareUpdate</span><span class=\"token punctuation\">(</span>\n  instance<span class=\"token punctuation\">,</span>\n  type<span class=\"token punctuation\">,</span>\n  oldProps<span class=\"token punctuation\">,</span>\n  newProps<span class=\"token punctuation\">,</span>\n  rootContainerInstance<span class=\"token punctuation\">,</span>\n  currentHostContext\n<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">/* update payload */</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><strong><em>Parameters</em></strong></p>\n<ul>\n<li><strong>instance</strong>: instance is the current dom instance of the node.</li>\n<li><strong>type</strong>: This contains the type of fiber i.e, ‚Äòdiv‚Äô, ‚Äòspan‚Äô, ‚Äòp‚Äô, ‚Äòinput‚Äô etc.</li>\n<li><strong>oldProps</strong>: props before this update.</li>\n<li><strong>newProps</strong>: new props.</li>\n<li><strong>rootContainerInstance</strong>: root dom node you specify while calling render. This is most commonly <code class=\"language-text\">&lt;div id=&quot;root&quot;&gt;&lt;/div&gt;</code></li>\n<li><strong>currentHostContext</strong>: contains the context from the parent node enclosing this node. This is the return value from <strong>getChildHostContext</strong> of the parent node.</li>\n</ul>\n<p><strong><em>Return Value</em></strong> This function should return a payload object. Payload is a Javascript object that can contain information on what needs to be changed on this host element. If returned true,</p>\n<p><strong><em>Purpose</em></strong>\nPrepare update is called first on the node, where the prop change occurs and then it is called on all the tree nodes recursively.\nThis method can be used to hint the reconciler whether an update needs to be performed on this node or not. If this function doesnt return anything, then reconciler decides whether the update should be performed on this node or not based on its algorithm.</p>\n<p>The idea is that we will NOT perform any dom changes in this function. Dom changes should be done on the commit phase of the renderer only. Once the tree traversal for the prepareUpdate is done, then prepareForCommit method will be called on rootContainer followed by <strong>commitUpdate</strong> on each node where we returned an updatePayload from <strong>prepareUpdate</strong>.</p>\n<p><strong><em>For our custom renderer</em></strong></p>\n<p>We will do nothing here.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\">prepareUpdate <span class=\"token punctuation\">:</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span>\n  instance<span class=\"token punctuation\">,</span>\n  type<span class=\"token punctuation\">,</span>\n  oldProps<span class=\"token punctuation\">,</span>\n  newProps<span class=\"token punctuation\">,</span>\n  rootContainerInstance<span class=\"token punctuation\">,</span>\n  currentHostContext\n<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">//return nothing.</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<hr>\n<h3>‚ñ∏ commitUpdate</h3>\n<hr>\n<p>The function signature is:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">function</span> <span class=\"token function\">commitUpdate</span><span class=\"token punctuation\">(</span>\n  instance<span class=\"token punctuation\">,</span>\n  updatePayload<span class=\"token punctuation\">,</span>\n  type<span class=\"token punctuation\">,</span>\n  oldProps<span class=\"token punctuation\">,</span>\n  newProps<span class=\"token punctuation\">,</span>\n  finishedWork\n<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">/* update payload */</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><strong><em>Parameters</em></strong></p>\n<ul>\n<li><strong>instance</strong>: instance is the current dom instance of the node.</li>\n<li><strong>updatePayload</strong>: update payload from <strong>prepareUpdate</strong> on the same node.</li>\n<li><strong>type</strong>: This contains the type of fiber i.e, ‚Äòdiv‚Äô, ‚Äòspan‚Äô, ‚Äòp‚Äô, ‚Äòinput‚Äô etc.</li>\n<li><strong>oldProps</strong>: props before this update.</li>\n<li><strong>newProps</strong>: new props.</li>\n<li><strong>finishedWork</strong>: The fiber node that manages work for this instance.</li>\n</ul>\n<p><strong><em>Purpose</em></strong>\nHere we perform all updates that we queued using prepareUpdate method. We will get the instance, the updatePayload, old and new props etc. This is where we should do all our dom manupulation work if needed.</p>\n<p><strong><em>For our custom renderer</em></strong></p>\n<p>We will do nothing here.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\">commitUpdate<span class=\"token punctuation\">:</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span>\n    instance<span class=\"token punctuation\">,</span>\n    updatePayload<span class=\"token punctuation\">,</span>\n    type<span class=\"token punctuation\">,</span>\n    oldProps<span class=\"token punctuation\">,</span>\n    newProps<span class=\"token punctuation\">,</span>\n    finishedWork\n  <span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">//return nothing.</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span></code></pre></div>\n<hr>\n<h3>‚ñ∏ commitTextUpdate</h3>\n<hr>\n<p>The function signature is:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">function</span> <span class=\"token function\">commitTextUpdate</span><span class=\"token punctuation\">(</span>textInstance<span class=\"token punctuation\">,</span> oldText<span class=\"token punctuation\">,</span> newText<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">/** perform dom update on textInstance **/</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><strong><em>Parameters</em></strong></p>\n<ul>\n<li><strong>textInstance</strong>: instance is the current text node on the dom.</li>\n<li><strong>oldText</strong>: text before this update.</li>\n<li><strong>newText</strong>: new text to be updated.</li>\n</ul>\n<p><strong><em>Purpose</em></strong>\nHere we perform the actual dom update on the textNode.</p>\n<p><strong><em>For our custom renderer</em></strong></p>\n<p>Lets update the text node.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\">commitTextUpdate<span class=\"token punctuation\">:</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span>textInstance<span class=\"token punctuation\">,</span> oldText<span class=\"token punctuation\">,</span> newText<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    textInstance<span class=\"token punctuation\">.</span>nodeValue <span class=\"token operator\">=</span> newText<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<hr>\n<p>Now, lets run our app and see what happens. Click that ‚ÄúGet current time‚Äù button üëäüèΩ. Our text field should now update to the latest value in the state. ü•≥ü•≥ü•≥</p>\n<h3>Order of Execution for Update</h3>\n<p>If you see the list of all functions in the hostConfig from React Dom source code, you should see a lot of functions that are not yet covered but seem like somewhat related to update functionality. After playing around a lot with the renderer this is the order of execution that I came up with.</p>\n<p>\n  <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/update_flow_draw_io-ae0214eb7406f3c0bb2fcaa7623c753b-2a78b.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n  \n  <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block; max-width:100% !important;; max-width: 777px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 74.25997425997426%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAAsSAAALEgHS3X78AAACEUlEQVQ4y4VU23KbMBTk//8nD3nqQztJ+tDU47FdxyUkXIy5mbuMJCRthYhpid2EQQMjcfacPbsHC/+5lFLT87wggZCGyKoMZVGiqipIKWcx1kdgfd+jbVvUdY2WtFC9gk1tOKmDJEpwzI9TsjPwp4BDFXEcG1AuFYrNAu56id+Og2fbhuu68DwPXdd9DnjOTimFEMLs7bwfeFw+YPFzie12izAMUZblx5THw7/AlPHxXd81CDpQQ/F8/m8R1rXqxmA1fUSawgD0ogc4sCEbOKED79WD7/tgjM0rvKaoUmOTZb0He/4CRRJwofeEwo7t4MQODsEBeZFPghjAOYiaVas1ACs1oPcAVicQekP2ArXQqrMWtNO9lWJWzFXKA92BBmN0aJtWkJgqxj0GJd4Sq8veWxGL0Daj1wbphbZKmDM8BURTHCP22QkVGStpaYOlu8CxztDKFutqjb2/RxAEyPMc1k1yg+1mi9VqhSRJ0HOOl4RhHTB0TIJyhe9PBTZ+awBzkuHO/gYvfTWA99m9ibe1JwfPWgUrzDQQQibHUy5REz7ZJy4ZqpOYaFVdM0wh1DXKlwaUuvEduKamZ003Xa+e60TCLHY6Iote0DWxOX/vDuu9TRTPkXp3CJ2vWmHb/BDedIIUHOT4C3n4iCZdanFOl4AzM5t3qceM6miJsPNxe7iFG7tI4xSRnukZGVzy/gOAgY3wHD7njQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n    >\n      <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;\"\n        alt=\"update flow\"\n        title=\"\"\n        src=\"/static/update_flow_draw_io-ae0214eb7406f3c0bb2fcaa7623c753b-2a78b.png\"\n        srcset=\"/static/update_flow_draw_io-ae0214eb7406f3c0bb2fcaa7623c753b-529eb.png 200w,\n/static/update_flow_draw_io-ae0214eb7406f3c0bb2fcaa7623c753b-19646.png 400w,\n/static/update_flow_draw_io-ae0214eb7406f3c0bb2fcaa7623c753b-2a78b.png 777w\"\n        sizes=\"(max-width: 777px) 100vw, 777px\"\n      />\n    </span>\n  </span>\n  \n  </a>\n    \n<em>(Right Click on the image and select <strong>Open Image in New Tab</strong> to get a better resolution version).</em></p>\n<p>This covers all the basic methods of the renderer during first time render and subsequent updates.</p>\n<h3>Methods used for edge cases (during Commit Phase)</h3>\n<p>Now if you take a look a the hostConfig, you will find that there are still few methods that are not covered yet. If you play around with renderer a bit more you will find thats some of those methods will be triggered during certain edge cases.</p>\n<hr>\n<h3>‚ñ∏ appendChild</h3>\n<hr>\n<p>The function signature is:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">function</span> <span class=\"token function\">appendChild</span><span class=\"token punctuation\">(</span>parentInstance<span class=\"token punctuation\">,</span> child<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span></code></pre></div>\n<p><strong><em>Parameters</em></strong></p>\n<ul>\n<li><strong>parentInstance</strong>: the parent dom node into which a new child node needs to be appended at the end.</li>\n<li><strong>child</strong>: the new dom node that needs to be inserted.</li>\n</ul>\n<p><strong><em>Purpose</em></strong>\nThis function is called whenever a new element needs to be inserted into a parent element at the end. For example:</p>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>p</span><span class=\"token punctuation\">></span></span> test <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>p</span><span class=\"token punctuation\">></span></span>\n  {this.state.test === \"yolo\" &amp;&amp; <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>button</span><span class=\"token punctuation\">></span></span> Hello <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>button</span><span class=\"token punctuation\">></span></span>}\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<p>So here when state.test becomes yolo. This function will be called with parentInstance = div and child = button in the commit Phase.</p>\n<p><strong><em>For our custom renderer</em></strong></p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\">appendChild<span class=\"token punctuation\">:</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span>parentInstance<span class=\"token punctuation\">,</span> child<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    parentInstance<span class=\"token punctuation\">.</span><span class=\"token function\">appendChild</span><span class=\"token punctuation\">(</span>child<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<hr>\n<h3>‚ñ∏ insertBefore</h3>\n<hr>\n<p>The function signature is:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">function</span> <span class=\"token function\">insertBefore</span><span class=\"token punctuation\">(</span>parentInstance<span class=\"token punctuation\">,</span> child<span class=\"token punctuation\">,</span> beforeChild<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span></code></pre></div>\n<p><strong><em>Parameters</em></strong></p>\n<ul>\n<li><strong>parentInstance</strong>: the parent dom node into which a new child node needs to be inserted.</li>\n<li><strong>child</strong>: the new dom node that needs to be inserted.</li>\n<li><strong>beforeChild</strong>: the child node before which the new child node needs to be inserted.</li>\n</ul>\n<p><strong><em>Purpose</em></strong></p>\n<p>This function is called whenever a new element needs to be inserted before a child element inside the parent element.\nFor Example:</p>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>p</span><span class=\"token punctuation\">></span></span> test <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>p</span><span class=\"token punctuation\">></span></span>\n  {this.state.test === \"yolo\" &amp;&amp; <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>button</span><span class=\"token punctuation\">></span></span>Hello<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>button</span><span class=\"token punctuation\">></span></span>}\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>p</span><span class=\"token punctuation\">></span></span> test2 <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>p</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<p>So here when state.test becomes yolo. This function will be called with parentInstance = div, beforeChild = p(test2) , child = button in the commit Phase.</p>\n<p><strong><em>For our custom renderer</em></strong></p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\">insertBefore<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">(</span>parentInstance<span class=\"token punctuation\">,</span> child<span class=\"token punctuation\">,</span> beforeChild<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  parentInstance<span class=\"token punctuation\">.</span><span class=\"token function\">insertBefore</span><span class=\"token punctuation\">(</span>child<span class=\"token punctuation\">,</span> beforeChild<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<hr>\n<h3>‚ñ∏ removeChild</h3>\n<hr>\n<p>The function signature is:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">function</span> <span class=\"token function\">removeChild</span><span class=\"token punctuation\">(</span>parentInstance<span class=\"token punctuation\">,</span> child<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span></code></pre></div>\n<p><strong><em>Parameters</em></strong></p>\n<ul>\n<li><strong>parentInstance</strong>: the parent dom node from which a the child node needs to be removed.</li>\n<li><strong>child</strong>: the dom node that needs to be removed.</li>\n</ul>\n<p><strong><em>Purpose</em></strong></p>\n<p>This function is called whenever an element needs to be removed from the parent element.\nFor Example:</p>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">></span></span>\n  {this.state.test === \"yolo\" &amp;&amp; <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>button</span><span class=\"token punctuation\">></span></span>Hello<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>button</span><span class=\"token punctuation\">></span></span>}\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<p>So here when state.test becomes something other than yolo.\nThis function will be called with parentInstance = div and child = button in the commit Phase.</p>\n<p><strong><em>For our custom renderer</em></strong></p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\">removeChild<span class=\"token punctuation\">:</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span>parentInstance<span class=\"token punctuation\">,</span> child<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n parentInstance<span class=\"token punctuation\">.</span><span class=\"token function\">removeChild</span><span class=\"token punctuation\">(</span>child<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<hr>\n<h3>‚ñ∏ insertInContainerBefore</h3>\n<hr>\n<p>The function signature is:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">function</span> <span class=\"token function\">insertInContainerBefore</span><span class=\"token punctuation\">(</span>container<span class=\"token punctuation\">,</span> child<span class=\"token punctuation\">,</span> beforeChild<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span></code></pre></div>\n<p><strong><em>Parameters</em></strong></p>\n<ul>\n<li><strong>container</strong>: the root container node to which a the child node needs to be inserted.</li>\n<li><strong>child</strong>: the dom node that needs to be inserted.</li>\n<li><strong>beforeChild</strong>: the child node before which the new child node needs to be inserted.</li>\n</ul>\n<p><strong><em>Purpose</em></strong></p>\n<p>This function is called whenever an element needs to insertedBefore the top most level component(Root component) itself.\nFor Example:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">const</span> <span class=\"token function-variable function\">App</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">(</span>\n  <span class=\"token operator\">&lt;</span><span class=\"token operator\">></span>\n    <span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">.</span>test <span class=\"token operator\">===</span> <span class=\"token string\">'yolo'</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token operator\">&lt;</span>button<span class=\"token operator\">></span>Hello<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>button<span class=\"token operator\">></span><span class=\"token punctuation\">}</span>\n    <span class=\"token operator\">&lt;</span>div<span class=\"token operator\">></span> World<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span>\n  <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span><span class=\"token operator\">></span>\n<span class=\"token punctuation\">)</span></code></pre></div>\n<p>So here when state.test becomes yolo.\nThis function will be called with container = root#div and child = div(World) and beforeChild = button in the commit Phase.</p>\n<p><strong><em>For our custom renderer</em></strong></p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\">insertInContainerBefore<span class=\"token punctuation\">:</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span>container<span class=\"token punctuation\">,</span> child<span class=\"token punctuation\">,</span> beforeChild<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  container<span class=\"token punctuation\">.</span><span class=\"token function\">insertBefore</span><span class=\"token punctuation\">(</span>child<span class=\"token punctuation\">,</span> beforeChild<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<hr>\n<h3>‚ñ∏ removeChildFromContainer</h3>\n<hr>\n<p>The function signature is:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">function</span> <span class=\"token function\">removeChildFromContainer</span><span class=\"token punctuation\">(</span>container<span class=\"token punctuation\">,</span> child<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span></code></pre></div>\n<p><strong><em>Parameters</em></strong></p>\n<ul>\n<li><strong>container</strong>: the root container node from which a the child node needs to be removed.</li>\n<li><strong>child</strong>: the dom node that needs to be removed.</li>\n</ul>\n<p><strong><em>Purpose</em></strong></p>\n<p>This function is called whenever an element is present at the top level as this <code class=\"language-text\">&lt;button&gt;</code> and needs to be removed.\nFor Example:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">const</span> <span class=\"token function-variable function\">App</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">(</span>\n  <span class=\"token operator\">&lt;</span><span class=\"token operator\">></span>\n    <span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">.</span>test <span class=\"token operator\">===</span> <span class=\"token string\">'yolo'</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token operator\">&lt;</span>button<span class=\"token operator\">></span>Hello<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>button<span class=\"token operator\">></span><span class=\"token punctuation\">}</span>\n    <span class=\"token operator\">&lt;</span>div<span class=\"token operator\">></span> World<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span>\n  <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span><span class=\"token operator\">></span>\n<span class=\"token punctuation\">)</span></code></pre></div>\n<p>So here when state.test becomes NOT yolo.\nThis function will be called with container = root#div and child=button in the commit Phase.</p>\n<p><strong><em>For our custom renderer</em></strong></p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\">removeChildFromContainer<span class=\"token punctuation\">:</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span>container<span class=\"token punctuation\">,</span> child<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  container<span class=\"token punctuation\">.</span><span class=\"token function\">removeChild</span><span class=\"token punctuation\">(</span>child<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<hr>\n<h3>‚ñ∏ resetTextContent</h3>\n<hr>\n<p>The function signature is:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">function</span> <span class=\"token function\">resetTextContent</span><span class=\"token punctuation\">(</span>domElement<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span></code></pre></div>\n<p><strong><em>Parameters</em></strong></p>\n<ul>\n<li><strong>domElement</strong>: the dom element for which the text content needs to be reset.</li>\n</ul>\n<p><strong><em>Purpose</em></strong></p>\n<p>Its used in react-dom to reset the text content of the dom element. But I couldnt find a way to initiate this function. Need to dig more. Hence, I am gonna leave it as a no operation function.</p>\n<p><strong><em>For our custom renderer</em></strong></p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\">resetTextContent<span class=\"token punctuation\">:</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span>domElement<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h2>Extras</h2>\n<hr>\n<h3>‚ñ∏ shouldDeprioritizeSubtree</h3>\n<hr>\n<p>The function signature is:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">function</span> <span class=\"token function\">shouldDeprioritizeSubtree</span><span class=\"token punctuation\">(</span>type<span class=\"token punctuation\">,</span> nextProps<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span></code></pre></div>\n<p><strong><em>Parameters</em></strong></p>\n<ul>\n<li><strong>type</strong>: the dom type of the element (p, span, div, etc).</li>\n<li><strong>nextProps</strong>: the props passed to the element.</li>\n</ul>\n<p><strong><em>Purpose</em></strong></p>\n<p>This function is used to deprioritize rendering of some subtrees. Mostly used in cases where the subtree is hidden or offscreen.\nIn react-dom code base this function contains:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">function</span> <span class=\"token function\">shouldDeprioritizeSubtree</span><span class=\"token punctuation\">(</span>type<span class=\"token punctuation\">,</span> nextProps<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token operator\">!</span><span class=\"token operator\">!</span>props<span class=\"token punctuation\">.</span>hidden\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>This can help improve rendering performance.</p>\n<p><strong><em>For our custom renderer</em></strong></p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\">shouldDeprioritizeSubtree<span class=\"token punctuation\">:</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span>type<span class=\"token punctuation\">,</span> nextProps<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token operator\">!</span><span class=\"token operator\">!</span>props<span class=\"token punctuation\">.</span>hidden\n<span class=\"token punctuation\">}</span></code></pre></div>","frontmatter":{"title":"‚öõÔ∏èü§ü Part 3/3 - Beginners guide to Custom React Renderers. How to build your own renderer from scratch?","date":"October 23, 2018"},"fields":{"slug":"/react-custom-renderer-3/"}}},"pageContext":{"slug":"/react-custom-renderer-3/","previous":{"fields":{"slug":"/react-custom-renderer-2/"},"frontmatter":{"title":"‚öõÔ∏è‚úåÔ∏è Part 2/3 - Beginners guide to Custom React Renderers. How to build your own renderer from scratch?"}},"next":null}}