{"componentChunkName":"component---src-pages-markdown-remark-frontmatter-slug-tsx","path":"/react-custom-renderer-1/","result":{"data":{"site":{"siteMetadata":{"title":"Blog","author":"Atul R"}},"markdownRemark":{"id":"4f583080-c510-5bf6-95d4-ffc6efd94131","excerpt":"This part will cover the basics needed to understand the renderer along with setup of boilerplate and initial configuration. We will cover inital render phase in ⚛️✌️ Part 2/3 - Beginners guide to Custom React Renderers… and Update phase the of…","html":"<p>This part will cover <strong>the basics</strong> needed to understand the renderer along with setup of boilerplate and initial configuration.</p>\n<ul>\n<li>We will cover inital render phase in <a href='/react-custom-renderer-2/' target='_blank'>⚛️✌️ Part 2/3 - Beginners guide to Custom React Renderers…</a> and</li>\n<li>Update phase the of renderer during setState <a href='/react-custom-renderer-3/' target='_blank'>⚛️🤟 Part 3/3 - Beginners guide to Custom React Renderers…</a></li>\n</ul>\n<hr>\n<p>React helps you write your UI declaratively.\n<a href=\"https://codeburst.io/declarative-vs-imperative-programming-a8a7c93d9ad2\" target=\"_blank\">More on declarative vs imperative here</a>. It was initially developed for Web, but since then it has been extended as\n<a href=\"https://facebook.github.io/react-native/\" target=\"_blank\">React Native</a>,\n<a href=\"https://github.com/Flipboard/react-canvas\" target=\"_blank\">React Canvas</a>,\n<a href=\"https://github.com/nitin42/redocx\" target=\"_blank\">Redocx</a>,\n<a href=\"https://github.com/diegomura/react-pdf\" target=\"_blank\">React PDF</a> and even\n<a href=\"https://github.com/iamdustan/react-hardware\" target=\"_blank\">React Hardware</a>.</p>\n<p><a href=\"https://github.com/chentsulin/awesome-react-renderer\" target=\"_blank\">There are a lot more out there and you can find them here</a></p>\n<p>I always wanted to learn how these renderers worked and in this post, I will explore React Renderers in detail. One of the talks that inspired me to take a look into this was by <a href=\"http://kenwheeler.github.io/\" target=\"_blank\">Ken Wheeler</a> at React Amsterdam 2017</p>\n<div class=\"gatsby-resp-iframe-wrapper\" style=\"padding-bottom: 56.25%; position: relative; height: 0; overflow: hidden; margin-bottom: 1.0725rem\" > <iframe src=\"https://www.youtube.com/embed/oPofnLZZTwQ\" frameborder=\"0\" allow=\"autoplay; encrypted-media\" style=\" position: absolute; top: 0; left: 0; width: 100%; height: 100%; \"></iframe> </div>\n<br />\n<br />\n<hr />\n<p><strong><em>Most of the content on this post is a result of my experimentation with React and reading through multiple react renderer codebases and blog posts. If you find any corrections in this post or any other extra details, please let me know in the comments.</em></strong></p>\n<h1 id=\"-before-we-dive-in\" style=\"position:relative;\"><a href=\"#-before-we-dive-in\" aria-label=\" before we dive in permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>📖 Before we dive in</h1>\n<p>Before we go ahead and implement custom renderers that will drive cars and power nuclear power plants (Let your imagination go crazy 🌈), its a good idea to revisit some basics. You can safely skip them and dive straight to next section, if you consider yourself a react ninja 🤺 who can build react apps blindfolded 😎.</p>\n<p><strong>Available React APIs from the main react module.</strong> <a href=\"https://reactjs.org/docs/react-api.html\" target=\"_blank\"> <a href=\"https://reactjs.org/docs/react-api.html\">https://reactjs.org/docs/react-api.html</a></a></p>\n<p><strong>Understanding JSX in depth.</strong> <a href=\"https://reactjs.org/docs/jsx-in-depth.html\" target=\"_blank\"><a href=\"https://reactjs.org/docs/jsx-in-depth.html\">https://reactjs.org/docs/jsx-in-depth.html</a></a></p>\n<h1 id=\"️-react-core-reconciler-and-renderer\" style=\"position:relative;\"><a href=\"#%EF%B8%8F-react-core-reconciler-and-renderer\" aria-label=\"️ react core reconciler and renderer permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>⚛️ React Core, Reconciler and Renderer</h1>\n<p><a href=\"https://reactjs.org/docs/codebase-overview.html\" target=\"_blank\">React codebase</a> can be divided into three major parts:</p>\n<h3 id=\"react-core\" style=\"position:relative;\"><a href=\"#react-core\" aria-label=\"react core permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>React Core</h3>\n<p>React core only includes the APIs necessary to define components. It contains all the top level React APIs like:</p>\n<ul>\n<li>React.createElement()</li>\n<li>React.createClass()</li>\n<li>React.Component</li>\n<li>React.Children</li>\n<li>React.PropTypes</li>\n</ul>\n<p>It doesnt include the diffing algorithm or any platform specific code.</p>\n<h3 id=\"renderer\" style=\"position:relative;\"><a href=\"#renderer\" aria-label=\"renderer permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Renderer</h3>\n<p>React was originally created for the DOM but it was later adapted to also support native platforms with React Native. This introduced the concept of “renderers” to React internals. Renderers manage how a React tree turns into the underlying platform calls. For example:</p>\n<ul>\n<li>React-Dom renders the component tree into respective dom elements.</li>\n<li>React Native renders the component tree into respective native platform views.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 800px; max-width:100% !important;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/cc397bd7316079f477f29f36fd058a80/6774c/common-reconciler.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 34.5%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAAsTAAALEwEAmpwYAAABZElEQVQoz1WN247aQBBE+f//ihIlYpUsSGBYsw7GY2aw8X3suflE2PuSbpVa1dVVvRnHkWmaGPWAHnq07hn1OlcMi77e6EVbMXxh5cYY6rpm45zDOwvlCR57XPabJv7BfN/BYwfVBec9zgdCewP5hyDfqePv6HS7eILaE9xE1/VsrLV476h6yU3FXG5HPkVEIk5kxYV6KPDOszy2Gt1KniqlVCnV40ZTCoyuCMHTtt0r0GGdIVI526vgZ5zw7XDi1+XK9poRFznB++Vp2/fEec/5VvN+zjj+VXyIBlE0eG/puo6Nsw4XDPFVcDoqjoect21MFEmigyQRghAczgXGoeSe7ZBij1IJ50Rw+hSk4v5/oLGGXAnSNEXkgkxkCJGRpldkccc5i7GOcXiiqw+m5oIZcuqqoCzuVE+FtWYN9N4zzzOvCgTKZ4l8SNquXXbzq+cVIbwYNO2AyCVN06y+L3/f9/wDplMUAEREozEAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"common reconciler\"\n        title=\"common reconciler\"\n        src=\"/static/cc397bd7316079f477f29f36fd058a80/5a190/common-reconciler.png\"\n        srcset=\"/static/cc397bd7316079f477f29f36fd058a80/772e8/common-reconciler.png 200w,\n/static/cc397bd7316079f477f29f36fd058a80/e17e5/common-reconciler.png 400w,\n/static/cc397bd7316079f477f29f36fd058a80/5a190/common-reconciler.png 800w,\n/static/cc397bd7316079f477f29f36fd058a80/c1b63/common-reconciler.png 1200w,\n/static/cc397bd7316079f477f29f36fd058a80/6774c/common-reconciler.png 1391w\"\n        sizes=\"(max-width: 800px) 100vw, 800px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<h3 id=\"reconciler\" style=\"position:relative;\"><a href=\"#reconciler\" aria-label=\"reconciler permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Reconciler</h3>\n<p>Reconciler is the diffing algorithm that helps react figure out which dom elements to update on a state change. It is the part of React code that is shared between multiple platform renderers like React Dom, React Native, React ART etc.\nThere are two types of reconcilers:</p>\n<ul>\n<li>\n<p><strong>Stack reconciler</strong>: The “stack” reconciler is the implementation powering React 15 and earlier. It is written in an object-oriented way and maintains a separate tree of “internal instances” for all React components. The internal instances exist both for user-defined (“composite”) and platform-specific (“host”) components. The internal instances are inaccessible directly to the user, and their tree is never exposed. It is important to understand that the stack reconciler always processes the component tree synchronously in a single pass. The stack reconciler can’t pause, and so it is suboptimal when the updates are deep and the available CPU time is limited. You can read more about it here: <a href=\"https://reactjs.org/docs/implementation-notes.html\" target=\"_blank\"><a href=\"https://reactjs.org/docs/implementation-notes.html\">https://reactjs.org/docs/implementation-notes.html</a></a></p>\n</li>\n<li>\n<p><strong>Fiber reconciler</strong>: The Fiber reconciler is a complete rewrite of the stack reconciler. It is the default reconciler since React 16. Fiber reconciler can perform the reconciliation of the tree by splitting work into minor chunks and hence can prioritize, pause and resume work thus freeing up the main thread to perform work efficiently. Hence, it appears more responsive and fluid as compared to stack reconciler. It mainly has:</p>\n<ul>\n<li>Ability to split interruptible work in chunks.</li>\n<li>Ability to prioritize, rebase and reuse work in progress.</li>\n<li>Ability to yield back and forth between parents and children to support layout in React.</li>\n<li>Ability to return multiple elements from render().</li>\n<li>Better support for error boundaries.</li>\n</ul>\n<p>To know more about fiber <a href=\" https://www.youtube.com/watch?v=ZCuYPiUIONs\" target=\"_blank\">you can watch the Cartoon intro to Fiber by Lin Clark</a></p>\n<p>To know more about <strong>Async rendering</strong>:</p>\n<ul>\n<li><strong>Time slicing &#x26; Suspense</strong>: <a href=\"https://www.youtube.com/watch?v=nLF0n9SACd4\" target=\"_blank\"> <a href=\"https://www.youtube.com/watch?v=nLF0n9SACd4\">https://www.youtube.com/watch?v=nLF0n9SACd4</a></a> and <a href=\"https://youtu.be/6g3g0Q_XVb4?t=1659\" target=\"_blank\"> <a href=\"https://youtu.be/6g3g0Q_XVb4?t=1659\">https://youtu.be/6g3g0Q_XVb4?t=1659</a></a> talks by Dan Abramov.</li>\n</ul>\n</li>\n</ul>\n<p>#🕵🏻‍ Components, Instances, Elements and Fiber</p>\n<p>Lets say we have a react app that looks like this:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">import</span> React <span class=\"token keyword\">from</span> <span class=\"token string\">'react'</span>\n<span class=\"token keyword\">import</span> ReactDom <span class=\"token keyword\">from</span> <span class=\"token string\">'react-dom'</span>\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">MyButton</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">React<span class=\"token punctuation\">.</span>Component</span> <span class=\"token punctuation\">{</span>\n  state <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span> text<span class=\"token operator\">:</span> <span class=\"token string\">'click me'</span> <span class=\"token punctuation\">}</span>\n  <span class=\"token function-variable function\">onBtnClick</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">setState</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> text<span class=\"token operator\">:</span> <span class=\"token string\">'I was clicked'</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token operator\">&lt;</span>button onClick<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>onBtnClick<span class=\"token punctuation\">}</span><span class=\"token operator\">></span> <span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">.</span>text<span class=\"token punctuation\">}</span> <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>button<span class=\"token operator\">></span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">Content</span> <span class=\"token operator\">=</span> <span class=\"token parameter\">props</span> <span class=\"token operator\">=></span> <span class=\"token operator\">&lt;</span>p<span class=\"token operator\">></span><span class=\"token punctuation\">{</span>props<span class=\"token punctuation\">.</span>text<span class=\"token punctuation\">}</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>p<span class=\"token operator\">></span>\n\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">App</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token operator\">&lt;</span>div<span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span>p style<span class=\"token operator\">=</span><span class=\"token string\">\"padding:20px\"</span><span class=\"token operator\">></span>Hello World<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>p<span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span>Content text<span class=\"token operator\">=</span><span class=\"token string\">\"hello world\"</span> <span class=\"token operator\">/</span><span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span>MyButton <span class=\"token operator\">/</span><span class=\"token operator\">></span>\n    <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span>\n  <span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span>\n\nReactDom<span class=\"token punctuation\">.</span><span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token operator\">&lt;</span>App <span class=\"token operator\">/</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">getElementById</span><span class=\"token punctuation\">(</span><span class=\"token string\">'root'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>Few fundamental units in the react-reconciler.</p>\n<h3 id=\"component\" style=\"position:relative;\"><a href=\"#component\" aria-label=\"component permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Component</h3>\n<p>In the above example: <strong>MyButton</strong>, <strong>Content</strong> and <strong>App</strong> are essentially components that you define. A Component can be defined as a class (MyButton) or as a function (Content and App). It is basically a declaration of how the UI elements should look and behave.</p>\n<p>With respect to renderers there are two types of react components:</p>\n<ul>\n<li>\n<p><strong>Host Components</strong>: Host components are platform-specific components, such as <code class=\"language-text\">&lt;div></code> or a <code class=\"language-text\">&lt;View></code> and they run platform-specific code such as mounting, updates, and unmounting of DOM/Native view. They typically begin with lower-case in the case of ReactDom.</p>\n</li>\n<li>\n<p><strong>Composite Components</strong>: Composite components are user-defined components such as <code class=\"language-text\">&lt;MyButton></code> or <code class=\"language-text\">&lt;Content></code> and they behave the same way with all renderers. React will calls methods, such as render() and componentDidMount(), on the user-supplied composite components.</p>\n</li>\n</ul>\n<h3 id=\"instances\" style=\"position:relative;\"><a href=\"#instances\" aria-label=\"instances permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Instances</h3>\n<p>For components declared as a class, the instances are the in memory initialized version of the components. An instance is what you refer to as <strong>this</strong> in the component class you write. It is useful for storing local state and reacting to the lifecycle events. There can be multiple independent instances of the same component. We will never create these instances manually, they will be managed by React. Also, functional components don’t have instances at all.</p>\n<h3 id=\"elements\" style=\"position:relative;\"><a href=\"#elements\" aria-label=\"elements permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Elements</h3>\n<p>An element is an immutable plain object describing a component instance or DOM node and its desired properties. The render function of the component returns an element. In case of functional components. The input is props while the output is a react element. Since elements are just plain light JS objects they are easy to traverse and don’t need to be parsed.</p>\n<p>To explain it lets take an example:</p>\n<p>Here <strong>Content</strong> is a functional component.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">const</span> <span class=\"token function-variable function\">Content</span> <span class=\"token operator\">=</span> <span class=\"token parameter\">props</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token operator\">&lt;</span>p style<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>props<span class=\"token punctuation\">.</span>style<span class=\"token punctuation\">}</span><span class=\"token operator\">></span><span class=\"token punctuation\">{</span>props<span class=\"token punctuation\">.</span>text<span class=\"token punctuation\">}</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>p<span class=\"token operator\">></span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Lets say we use it as</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token operator\">&lt;</span>Content style<span class=\"token operator\">=</span><span class=\"token string\">\"background:blue;\"</span> text<span class=\"token operator\">=</span><span class=\"token string\">\"hello world\"</span> <span class=\"token operator\">/</span><span class=\"token operator\">></span></code></pre></div>\n<p>This will tell React to call render on this component and return a React Element.</p>\n<p>To see how it looks, we can <strong>console.log</strong> it.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">const</span> props <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span> text<span class=\"token operator\">:</span> <span class=\"token string\">'hello world'</span><span class=\"token punctuation\">,</span> style<span class=\"token operator\">:</span> <span class=\"token string\">'background:blue;'</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\nconsole<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token function\">Content</span><span class=\"token punctuation\">(</span>props<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\">// This logs</span>\n<span class=\"token punctuation\">{</span>\n  <span class=\"token string\">\"type\"</span><span class=\"token operator\">:</span><span class=\"token string\">\"p\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token string\">\"props\"</span><span class=\"token operator\">:</span><span class=\"token punctuation\">{</span>\n    <span class=\"token string\">\"style\"</span><span class=\"token operator\">:</span><span class=\"token string\">\"background:blue;\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">\"children\"</span><span class=\"token operator\">:</span><span class=\"token string\">\"hello world\"</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>This is a react element for the component. It contains only information about the component type <strong>p</strong>, its props (style, children). In otherwords, it is a lightweight javascript object that contains only the information needed to draw the element on the screen.</p>\n<p>Now what if we do this with App:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">const</span> <span class=\"token function-variable function\">App</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token operator\">&lt;</span>div<span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span>p style<span class=\"token operator\">=</span><span class=\"token string\">\"padding:20px\"</span><span class=\"token operator\">></span>Hello World<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>p<span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span>Content text<span class=\"token operator\">=</span><span class=\"token string\">\"hello world\"</span> <span class=\"token operator\">/</span><span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span>MyButton <span class=\"token operator\">/</span><span class=\"token operator\">></span>\n    <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span>\n  <span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span>\nconsole<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token function\">App</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\">// This would log</span>\n<span class=\"token punctuation\">{</span>\n   <span class=\"token string\">\"type\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"div\"</span><span class=\"token punctuation\">,</span>\n   <span class=\"token string\">\"props\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token string\">\"children\"</span><span class=\"token operator\">:</span><span class=\"token punctuation\">[</span>\n         <span class=\"token punctuation\">{</span>\n            <span class=\"token string\">\"type\"</span><span class=\"token operator\">:</span><span class=\"token string\">\"p\"</span><span class=\"token punctuation\">,</span>\n            <span class=\"token string\">\"props\"</span><span class=\"token operator\">:</span><span class=\"token punctuation\">{</span>\n               <span class=\"token string\">\"style\"</span><span class=\"token operator\">:</span><span class=\"token string\">\"padding:20px\"</span><span class=\"token punctuation\">,</span>\n               <span class=\"token string\">\"children\"</span><span class=\"token operator\">:</span><span class=\"token string\">\"Hello World\"</span>\n            <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n         <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n         <span class=\"token punctuation\">{</span>\n           <span class=\"token string\">\"type\"</span><span class=\"token operator\">:</span> ƒ <span class=\"token function\">Content</span><span class=\"token punctuation\">(</span>props<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n           <span class=\"token string\">\"props\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span><span class=\"token string\">\"text\"</span><span class=\"token operator\">:</span><span class=\"token string\">\"hello world\"</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n         <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n         <span class=\"token punctuation\">{</span>\n           <span class=\"token string\">\"type\"</span><span class=\"token operator\">:</span> ƒ <span class=\"token function\">MyButton</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n         <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n      <span class=\"token punctuation\">]</span>\n   <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>If you notice carefully, The second and third child has type which is not a string. They are functions(basically components). Now, react reconciler would call render on those children for which the type is not a string. This would happen recursively till react can resolve all the types to strings. Hence, if a react element type is a string it is a dom element otherwise it is a Component.</p>\n<p>I recommend reading the more detailed version by Dan Abramov here: <a href=\"https://reactjs.org/blog/2015/12/18/react-components-elements-and-instances.html\" target=\"_blank\"><a href=\"https://reactjs.org/blog/2015/12/18/react-components-elements-and-instances.html\">https://reactjs.org/blog/2015/12/18/react-components-elements-and-instances.html</a></a></p>\n<h3 id=\"fiber\" style=\"position:relative;\"><a href=\"#fiber\" aria-label=\"fiber permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>fiber</h3>\n<p>This was introduced in the new React Fiber Reconciler. A fiber (lowecase f) is a JavaScript object that contains information about a component, its input and output. It has a one to one relation with the instance. It manages the work for the instance. The fiber keeps track of the instance using the property stateNode. And it also has information about its relationship with other instances. At any time, a component instance has at most two fibers that correspond to it: the current (flushed fiber or rendered fiber) and the work-in-progress fiber. A fiber node looks like this</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token punctuation\">{</span>\n  child<span class=\"token punctuation\">,</span> stateNode<span class=\"token punctuation\">,</span> siblings<span class=\"token punctuation\">,</span> alternate<span class=\"token punctuation\">,</span> <span class=\"token keyword\">return</span><span class=\"token punctuation\">,</span> type<span class=\"token punctuation\">,</span> key\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><a href=\"https://github.com/facebook/react/blob/9ea4bc6ed607b0bbd2cff7bbdd4608db99490a5f/packages/react-reconciler/src/ReactFiber.js#L406\" target=\"_blank\">From the source code </a> I could understand that React Fiber reconciler uses the react element to generate a react fiber for the component instance. So you can think of it as a react element with time management super powers🥇.\n<a href='https://giamir.com/what-is-react-fiber' target='_blank'>You can find more details about the fiber here</a></p>\n<p>Now that we are done with crash course on React Internal elements, lets do what we came here for.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 800px; max-width:100% !important;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/c76c6c9e5ec71156b5c571f5513873a8/56e36/brace-yourself-meme.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 32%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAIAAABM9SnKAAAACXBIWXMAAC4jAAAuIwF4pT92AAABQUlEQVQY02P4////v3///v//f/Pmzfnz5s2d1FFfVbJ5y+bZs2f39fVGRCRXVXasWbh02YwZtVX1zraez548/////9+/IC0McM2PHj3auXNna0lKpKdVaUHWpo0bV6xYnp5c1F/TOaOyoi8p0tMuwNrE6+Xzl1g0f/jwcc/ObXFhATHBniHedlOnTDp77vzcCdPm1JXPrC9f3lafHVtiomX57MljsOa/KJrfffgwc8rE1pIcFwcrQz2NkJCQ48ePTu7sWz5hyvzOqovbNx5bt83V1ObJg/somiGsGzdverq55memGxnqK8hJqSgrhIW7tlcWHly2cWFn08kNq16fOp8fl379+nUUzX/+/Pn///+WLZtUVFRio8KU5CXFxEQlJYTt7Yy7aqsX9kxZMWnmku7WE8vXrZ28/O6duyDHgv0MAPR072n0koJyAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"brace yourselves\"\n        title=\"brace yourselves\"\n        src=\"/static/c76c6c9e5ec71156b5c571f5513873a8/5a190/brace-yourself-meme.png\"\n        srcset=\"/static/c76c6c9e5ec71156b5c571f5513873a8/772e8/brace-yourself-meme.png 200w,\n/static/c76c6c9e5ec71156b5c571f5513873a8/e17e5/brace-yourself-meme.png 400w,\n/static/c76c6c9e5ec71156b5c571f5513873a8/5a190/brace-yourself-meme.png 800w,\n/static/c76c6c9e5ec71156b5c571f5513873a8/c1b63/brace-yourself-meme.png 1200w,\n/static/c76c6c9e5ec71156b5c571f5513873a8/29007/brace-yourself-meme.png 1600w,\n/static/c76c6c9e5ec71156b5c571f5513873a8/56e36/brace-yourself-meme.png 1750w\"\n        sizes=\"(max-width: 800px) 100vw, 800px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<h1 id=\"-lets-build-a-custom-renderer\" style=\"position:relative;\"><a href=\"#-lets-build-a-custom-renderer\" aria-label=\" lets build a custom renderer permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>👷🏻‍ Lets build a custom renderer</h1>\n<h2 id=\"boilerplate-setup\" style=\"position:relative;\"><a href=\"#boilerplate-setup\" aria-label=\"boilerplate setup permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Boilerplate setup</h2>\n<p>Lets create a basic create-react-app project.</p>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\">npx create-react-app renderer\ncd renderer</code></pre></div>\n<p>Now delete all the files inside the <strong>src/</strong> directory except <strong>index.js</strong>.\nAnd create a directory structure like this.</p>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\">.\n├── README.md\n├── package.json\n├── node_modules\n├── public\n├── src\n│   ├── index.js #remove everything except index.js\n│   └── renderer\n│       └── index.js  #This is a new file\n└── yarn.lock</code></pre></div>\n<p>Now modify <strong>src/index.js</strong> to look like this:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">import</span> React <span class=\"token keyword\">from</span> <span class=\"token string\">'react'</span>\n<span class=\"token keyword\">import</span> ReactDOM <span class=\"token keyword\">from</span> <span class=\"token string\">'react-dom'</span>\n\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">Text</span> <span class=\"token operator\">=</span> <span class=\"token parameter\">props</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token operator\">&lt;</span>p className<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>props<span class=\"token punctuation\">.</span>className<span class=\"token punctuation\">}</span><span class=\"token operator\">></span><span class=\"token punctuation\">{</span>props<span class=\"token punctuation\">.</span>content<span class=\"token punctuation\">}</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>p<span class=\"token operator\">></span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">App</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token operator\">&lt;</span>div<span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span>Text className<span class=\"token operator\">=</span><span class=\"token string\">\"hello-class\"</span> content<span class=\"token operator\">=</span><span class=\"token string\">\"Hello\"</span> <span class=\"token operator\">/</span><span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span>span style<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> color<span class=\"token operator\">:</span> <span class=\"token string\">'blue'</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span><span class=\"token operator\">></span>World<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>span<span class=\"token operator\">></span>\n    <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span>\n  <span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span>\n\nReactDOM<span class=\"token punctuation\">.</span><span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token operator\">&lt;</span>App <span class=\"token operator\">/</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">getElementById</span><span class=\"token punctuation\">(</span><span class=\"token string\">'root'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>Run it</p>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\">npm start</code></pre></div>\n<br/>\n<p>You should see our basic app loaded up on <a href=\"http://localhost:3000/\">http://localhost:3000/</a> and it should look like this.\n<br/>\n<br/>\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 800px; max-width:100% !important;\"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 37.99999999999999%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAZElEQVQoz7WPsQqAMAxE8/+f56a1CC04qG10sZly0uLiphADj+OWx4U61yPGGcu6IfOOzAf8FDGMAc7HF4QHVERQiiCljMyM1kVwljs/QjA+UlVYQoCxULUOrcXo5aazsv0hvABbNHP5mpMTWAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"boilerplate demo\"\n        title=\"boilerplate demo\"\n        src=\"/static/57038aa4f8a135a0dbf59fa48d5164c0/5a190/boilerplate_start_demo.png\"\n        srcset=\"/static/57038aa4f8a135a0dbf59fa48d5164c0/772e8/boilerplate_start_demo.png 200w,\n/static/57038aa4f8a135a0dbf59fa48d5164c0/e17e5/boilerplate_start_demo.png 400w,\n/static/57038aa4f8a135a0dbf59fa48d5164c0/5a190/boilerplate_start_demo.png 800w,\n/static/57038aa4f8a135a0dbf59fa48d5164c0/c1b63/boilerplate_start_demo.png 1200w,\n/static/57038aa4f8a135a0dbf59fa48d5164c0/29007/boilerplate_start_demo.png 1600w,\n/static/57038aa4f8a135a0dbf59fa48d5164c0/e2cbf/boilerplate_start_demo.png 2138w\"\n        sizes=\"(max-width: 800px) 100vw, 800px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<hr/>\nThe basic premise is that our renderer should be able to render the same result for the App component.\n<p>Modify our <strong>src/index.js</strong> to use our renderer(Lets call it Custom Renderer) instead of <strong>react-dom</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">import</span> React <span class=\"token keyword\">from</span> <span class=\"token string\">'react'</span>\n<span class=\"token comment\">// import ReactDOM from \"react-dom\";</span>\n<span class=\"token keyword\">import</span> CustomRenderer <span class=\"token keyword\">from</span> <span class=\"token string\">'./renderer'</span>\n\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">Text</span> <span class=\"token operator\">=</span> <span class=\"token parameter\">props</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token operator\">&lt;</span>p className<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>props<span class=\"token punctuation\">.</span>className<span class=\"token punctuation\">}</span><span class=\"token operator\">></span><span class=\"token punctuation\">{</span>props<span class=\"token punctuation\">.</span>content<span class=\"token punctuation\">}</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>p<span class=\"token operator\">></span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">App</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token operator\">&lt;</span>div<span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span>Text className<span class=\"token operator\">=</span><span class=\"token string\">\"hello-class\"</span> content<span class=\"token operator\">=</span><span class=\"token string\">\"Hello\"</span> <span class=\"token operator\">/</span><span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span>span style<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> color<span class=\"token operator\">:</span> <span class=\"token string\">'blue'</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span><span class=\"token operator\">></span>World<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>span<span class=\"token operator\">></span>\n    <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span>\n  <span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\">// ReactDOM.render(&lt;App />, document.getElementById(\"root\"));</span>\nCustomRenderer<span class=\"token punctuation\">.</span><span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token operator\">&lt;</span>App <span class=\"token operator\">/</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">getElementById</span><span class=\"token punctuation\">(</span><span class=\"token string\">'root'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>Lets add some code to <strong>src/renderer/index.js</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">const</span> CustomRenderer <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">element<span class=\"token punctuation\">,</span> renderDom<span class=\"token punctuation\">,</span> callback</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// element: This is the react element for App component</span>\n    <span class=\"token comment\">// renderDom: This is the host root element to which the rendered app will be attached.</span>\n    <span class=\"token comment\">// callback: if specified will be called after render is done.</span>\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'render called'</span><span class=\"token punctuation\">,</span> element<span class=\"token punctuation\">,</span> renderDom<span class=\"token punctuation\">,</span> callback<span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span>\n\nmodule<span class=\"token punctuation\">.</span>exports <span class=\"token operator\">=</span> CustomRenderer</code></pre></div>\n<p>Now if we check <a href=\"http://localhost:3000\">http://localhost:3000</a> we should see a blank white screen but checking our browser console we should see:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\">render called <span class=\"token punctuation\">{</span>$$<span class=\"token keyword\">typeof</span><span class=\"token operator\">:</span> <span class=\"token function\">Symbol</span><span class=\"token punctuation\">(</span>react<span class=\"token punctuation\">.</span>element<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> type<span class=\"token operator\">:</span> ƒ<span class=\"token punctuation\">,</span> key<span class=\"token operator\">:</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">,</span> ref<span class=\"token operator\">:</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">,</span> props<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>…<span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> …<span class=\"token punctuation\">}</span> div#root <span class=\"token keyword\">undefined</span></code></pre></div>\n<br>\n<p><strong><a href='https://github.com/a7ul/blog-custom-renderer/tree/5306e949bba475f80cab5a042535af5755c0aa43' target='_blank'>Link to source code till here</a></strong></p>\n<br>\n<p>Cool😎!! . Now to figure out what goes into render function, I had to read through multiple renderer codebases and documentations. This is what I understood.👨🏻‍🎓</p>\n<ul>\n<li>The React team exported an experimental version of <strong>react-reconciler</strong> as a npm package.</li>\n<li>Every platform renderer, be it dom, react native, etc has to have its own configuration called <strong>hostConfig</strong> along with the <strong>react-reconciler</strong>. Renderers are required to implement all the necessary platform specfic functions inside the <strong>hostConfig</strong>. The <a href='https://github.com/facebook/react/tree/master/packages/react-reconciler' target='_blank'>\nreact-reconciler</a> module inside the renderer will call the platform specific functions via the supplied hostConfig to perform dom changes or view updates.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 800px; max-width:100% !important;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/b40144a4a98fe32977b74a1d1019a7dd/2ad15/renderer_in_short.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 32.49999999999999%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAAsTAAALEwEAmpwYAAAA4UlEQVQoz42RX2uDQBDE8/0/UelroY9SGqsvtndERBsNamK88/74Kx4NbYK02YfdhR2GmZ0NNzXPM/P3bqxHyh1SSoQQ5Hl+hfs9L7W5JQvTdLizwA4Cfcopq4qyLCmKgrquMcaskq0SLpBZ5XS7RxrxgO1e2G7fiKKIJEnIsoymaX7wfykkAJbF4qYOMx4AzTRNaK1Yc/OPwtAxDg5Hw75VKEsgHMeRYRjo+x7n3H0KL8fP3vGcNDy9VrzvLVJ8EMcxaZqGYBbL3vv7Q1GTpx087dlzUj6EoPViW1//eyWUL5l3Icl2i/2qAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"renderer in short\"\n        title=\"renderer in short\"\n        src=\"/static/b40144a4a98fe32977b74a1d1019a7dd/5a190/renderer_in_short.png\"\n        srcset=\"/static/b40144a4a98fe32977b74a1d1019a7dd/772e8/renderer_in_short.png 200w,\n/static/b40144a4a98fe32977b74a1d1019a7dd/e17e5/renderer_in_short.png 400w,\n/static/b40144a4a98fe32977b74a1d1019a7dd/5a190/renderer_in_short.png 800w,\n/static/b40144a4a98fe32977b74a1d1019a7dd/2ad15/renderer_in_short.png 801w\"\n        sizes=\"(max-width: 800px) 100vw, 800px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>Now lets install <strong>react-reconciler</strong> package from npm.</p>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\">yarn add react-reconciler</code></pre></div>\n<p>Now modify <strong>src/renderer/index.js</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">const</span> Reconciler <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'react-reconciler'</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">const</span> HostConfig <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">//TODO We will specify all required methods here</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token keyword\">const</span> reconcilerInstance <span class=\"token operator\">=</span> <span class=\"token function\">Reconciler</span><span class=\"token punctuation\">(</span>HostConfig<span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">const</span> CustomRenderer <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">element<span class=\"token punctuation\">,</span> renderDom<span class=\"token punctuation\">,</span> callback</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// element: This is the react element for App component</span>\n    <span class=\"token comment\">// renderDom: This is the host root element to which the rendered app will be attached.</span>\n    <span class=\"token comment\">// callback: if specified will be called after render is done.</span>\n\n    <span class=\"token keyword\">const</span> isAsync <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span> <span class=\"token comment\">// Disables async rendering</span>\n    <span class=\"token keyword\">const</span> container <span class=\"token operator\">=</span> reconcilerInstance<span class=\"token punctuation\">.</span><span class=\"token function\">createContainer</span><span class=\"token punctuation\">(</span>renderDom<span class=\"token punctuation\">,</span> isAsync<span class=\"token punctuation\">)</span> <span class=\"token comment\">// Creates root fiber node.</span>\n\n    <span class=\"token keyword\">const</span> parentComponent <span class=\"token operator\">=</span> <span class=\"token keyword\">null</span> <span class=\"token comment\">// Since there is no parent (since this is the root fiber). We set parentComponent to null.</span>\n    reconcilerInstance<span class=\"token punctuation\">.</span><span class=\"token function\">updateContainer</span><span class=\"token punctuation\">(</span>\n      element<span class=\"token punctuation\">,</span>\n      container<span class=\"token punctuation\">,</span>\n      parentComponent<span class=\"token punctuation\">,</span>\n      callback\n    <span class=\"token punctuation\">)</span> <span class=\"token comment\">// Start reconcilation and render the result</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span>\n\nmodule<span class=\"token punctuation\">.</span>exports <span class=\"token operator\">=</span> CustomRenderer</code></pre></div>\n<p><strong>Whats happening?</strong></p>\n<ul>\n<li>First we create an instance of the reconciler. We pass the hostConfig as its parameter. We will define the methods inside hostConfig in a bit.</li>\n<li>Now inside the render method, our first step is to create a root fiber node (container) corresponding to the renderDom element. We do this by calling <strong>reconcilerInstance.createContainer</strong>. The root fiber node will be used by the reconciler to manage all the updates to the renderDom.</li>\n<li>After we create the root fiber node (container), we will call <strong>reconcilerInstance.updateContainer</strong>. This will initiate reconcilation and the subsequent rendering.</li>\n</ul>\n<p>Now you might have noticed we set <strong>isAsync</strong> to false. This parameter is used to set the mode of working for the fiber node. When set to false it disables AsyncMode.<br/>\nA fiber can run on a mixture of modes. Few of them are:<br/></p>\n<ul>\n<li><strong>AsyncMode</strong> - Enables Async rendering. But since it is not stable yet, it is disabled on all renderers by default. Check status <a href='https://github.com/facebook/react/issues/13206#issuecomment-407535077' target='_blank'>of async rendering here.</a> <br/></li>\n<li><strong>StrictMode</strong> - Enables <a href='https://reactjs.org/docs/strict-mode.html' target='_blank'>React Strict mode.</a> <br/></li>\n<li><strong>ProfileMode</strong> - Helps in performance profiling I guess. 🤷🏻‍ <br/></li>\n<li><strong>NoContext</strong> - When no mode is not specified.</li>\n</ul>\n<p>At the time of writing this blog, React 16.5.2, React Native 0.57 and all currently available release versions of renderers have async mode disabled. So they all are running on sync mode at the moment. Also,</p>\n<blockquote>\n<p>When a fiber is created, it inherits the mode of its\nparent. Additional flags can be set at creation time, but after that the\nvalue should remain unchanged throughout the fiber’s lifetime.</p>\n</blockquote>\n<p>Hence, if we set the mode of container (root fiber) as “not async”. All remaining child fibers will be “non async” too. More about <a href='https://github.com/facebook/react/blob/b5c0852fddda9abdab25b101a040e607877f4663/packages/react-reconciler/src/ReactFiber.js#L85' target='_blank'><strong>fiber node here</strong>.</a></p>\n<p>Lets try and run our react app now.</p>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\">yarn start</code></pre></div>\n<p>You should get an awesome error screen that looks like this:\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 800px; max-width:100% !important;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/e4cf725cd4373440712b73c54227f736/efa1a/first_error_now.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 35.50000000000001%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAABYlAAAWJQFJUiTwAAABAElEQVQoz5WQ226DMBAF+f8/q5r0pkiVUqU0JOSCMQRsjMBeTwVpnpOuNJp9ODpabdJle/r8iC81Y1HODMczYRiRGIkx8uiM3pMopbhUFcYYmtZgW8NgOwbnGPseGUcIgej9XaZcotOUerVi/bxgvXwhf/ugSX/wWuObBn+5zBZj7tN1JOV2S5umFN8px82GOtuhsgy131MfDpS7HVWe47Sm13q2K0s6pQhtS7QWsdfCOBVaYzHW4qeTbzO9TeKfr7sEIYarb8QpI3H2jcTaCn3KqYuCcbBI7AniZkQcMf6HnsQ1n9T5E+q0RJ0XNOqd6viKzpe49guRE8EfHkJCwS8b8xyCzELwzQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"first error now not found\"\n        title=\"first error now not found\"\n        src=\"/static/e4cf725cd4373440712b73c54227f736/5a190/first_error_now.png\"\n        srcset=\"/static/e4cf725cd4373440712b73c54227f736/772e8/first_error_now.png 200w,\n/static/e4cf725cd4373440712b73c54227f736/e17e5/first_error_now.png 400w,\n/static/e4cf725cd4373440712b73c54227f736/5a190/first_error_now.png 800w,\n/static/e4cf725cd4373440712b73c54227f736/c1b63/first_error_now.png 1200w,\n/static/e4cf725cd4373440712b73c54227f736/29007/first_error_now.png 1600w,\n/static/e4cf725cd4373440712b73c54227f736/efa1a/first_error_now.png 2040w\"\n        sizes=\"(max-width: 800px) 100vw, 800px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>This is because we havent implemented the required methods in the HostConfig yet 💩.</p>\n<br>\n<p><strong><a href='https://github.com/a7ul/blog-custom-renderer/tree/b0f74ffc14eecceb259c5b302cf170cce843d3b1' target='_blank'>Link to source code till here</a></strong></p>\n<br>\n<hr>\n<p>We will continue with rest of the post here: <a href='/react-custom-renderer-2/' target='_blank'>⚛️✌️ Part 2/3 - Beginners guide to Custom React Renderers. How to build your own renderer from scratch?</a>.</p>\n<hr>\n<h1 id=\"references\" style=\"position:relative;\"><a href=\"#references\" aria-label=\"references permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>References</h1>\n<ul>\n<li>Building React From Scratch by Paul O Shannessy - <a href=\"https://www.youtube.com/watch?v=_MAD4Oly9yg\" target=\"_blank\" ><a href=\"https://www.youtube.com/watch?v=%5C_MAD4Oly9yg\">https://www.youtube.com/watch?v=\\_MAD4Oly9yg</a></a></li>\n<li><a href=\"https://reactjs.org/docs/react-api.html\">https://reactjs.org/docs/react-api.html</a></li>\n<li><a href=\"https://reactjs.org/blog/2015/12/18/react-components-elements-and-instances.html\">https://reactjs.org/blog/2015/12/18/react-components-elements-and-instances.html</a></li>\n<li><a href=\"https://reactjs.org/docs/jsx-in-depth.html\">https://reactjs.org/docs/jsx-in-depth.html</a></li>\n<li><a href=\"https://reactjs.org/docs/implementation-notes.html\">https://reactjs.org/docs/implementation-notes.html</a></li>\n<li><a href=\"https://giamir.com/what-is-react-fiber\">https://giamir.com/what-is-react-fiber</a></li>\n<li>React Suspense implementation by Kent C. Dodds : <a href='https://www.youtube.com/watch?v=7LmrS2sdMlo' target='_blank'><a href=\"https://www.youtube.com/watch?v=7LmrS2sdMlo\">https://www.youtube.com/watch?v=7LmrS2sdMlo</a></a></li>\n<li><a href=\"https://github.com/sw-yx/fresh-async-react\">https://github.com/sw-yx/fresh-async-react</a></li>\n<li><a href=\"https://github.com/acdlite/react-fiber-architecture\">https://github.com/acdlite/react-fiber-architecture</a></li>\n<li><a href=\"https://reactjs.org/docs/codebase-overview.html\">https://reactjs.org/docs/codebase-overview.html</a></li>\n</ul>","headings":[{"value":"📖 Before we dive in","depth":1},{"value":"⚛️ React Core, Reconciler and Renderer","depth":1},{"value":"React Core","depth":3},{"value":"Renderer","depth":3},{"value":"Reconciler","depth":3},{"value":"Component","depth":3},{"value":"Instances","depth":3},{"value":"Elements","depth":3},{"value":"fiber","depth":3},{"value":"👷🏻‍ Lets build a custom renderer","depth":1},{"value":"Boilerplate setup","depth":2},{"value":"References","depth":1}],"frontmatter":{"title":"⚛️👆 Part 1/3 - Beginners guide to Custom React Renderers. How to build your own renderer from scratch?","slug":"react-custom-renderer-1","date":"October 21, 2018","keywords":"custom, react, renderer, beginners, guide, javascript"}}},"pageContext":{"id":"4f583080-c510-5bf6-95d4-ffc6efd94131","frontmatter__slug":"react-custom-renderer-1","__params":{"frontmatter__slug":"react-custom-renderer-1"}}},"staticQueryHashes":[]}