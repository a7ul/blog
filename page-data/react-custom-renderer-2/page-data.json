{"componentChunkName":"component---src-templates-blog-post-js","path":"/react-custom-renderer-2/","webpackCompilationHash":"bb189d689df1f7691f2e","result":{"data":{"site":{"siteMetadata":{"title":"Blog","author":"Atul R"}},"markdownRemark":{"id":"4ecbd545-2a7d-553d-a98f-48e79a2bb720","excerpt":"This is the continuation of the post here: ‚öõÔ∏èüëÜ Part 1/3 - Beginners guide to Custom React Renderers. How to build your own renderer from scratch?. I would strongly recommend reading Part 1 before‚Ä¶","html":"<hr>\n<p>This is the continuation of the post here: <a href='/react-custom-renderer-1/' target='_blank'>‚öõÔ∏èüëÜ Part 1/3 - Beginners guide to Custom React Renderers. How to build your own renderer from scratch?</a>. I would strongly recommend reading Part 1 before. This part will cover <strong>the initial render phase of the renderer</strong>.</p>\n<ul>\n<li>The update phase would be covered in <a href='/react-custom-renderer-3/' target='_blank'>‚öõÔ∏èü§ü Part 3/3 - Beginners guide to Custom React Renderers. How to build your own renderer from scratch?</a>.</li>\n</ul>\n<hr>\n<h2>HostConfig</h2>\n<p><strong>Recap</strong>: Renderers are required to implement all the necessary platform specfic functions inside the <strong>HostConfig</strong>.\nOur HostConfig looks like this at the moment.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">const</span> HostConfig <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">//TODO We will specify all required methods here</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<br/>\n<p>From the <a href='https://github.com/facebook/react/blob/dac9202a9c5add480f853bcad2ee04d371e72c0c/packages/react-reconciler/src/forks/ReactFiberHostConfig.custom.js' target='_blank'>source code of <strong>react-reconciler</strong></a>, we find the complete list of methods in hostConfig\nas follows:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\">HostConfig<span class=\"token punctuation\">.</span>getPublicInstance\nHostConfig<span class=\"token punctuation\">.</span>getRootHostContext\nHostConfig<span class=\"token punctuation\">.</span>getChildHostContext\nHostConfig<span class=\"token punctuation\">.</span>prepareForCommit\nHostConfig<span class=\"token punctuation\">.</span>resetAfterCommit\nHostConfig<span class=\"token punctuation\">.</span>createInstance\nHostConfig<span class=\"token punctuation\">.</span>appendInitialChild\nHostConfig<span class=\"token punctuation\">.</span>finalizeInitialChildren\nHostConfig<span class=\"token punctuation\">.</span>prepareUpdate\nHostConfig<span class=\"token punctuation\">.</span>shouldSetTextContent\nHostConfig<span class=\"token punctuation\">.</span>shouldDeprioritizeSubtree\nHostConfig<span class=\"token punctuation\">.</span>createTextInstance\nHostConfig<span class=\"token punctuation\">.</span>scheduleDeferredCallback\nHostConfig<span class=\"token punctuation\">.</span>cancelDeferredCallback\nHostConfig<span class=\"token punctuation\">.</span>setTimeout\nHostConfig<span class=\"token punctuation\">.</span>clearTimeout\nHostConfig<span class=\"token punctuation\">.</span>noTimeout\nHostConfig<span class=\"token punctuation\">.</span>now\nHostConfig<span class=\"token punctuation\">.</span>isPrimaryRenderer\nHostConfig<span class=\"token punctuation\">.</span>supportsMutation\nHostConfig<span class=\"token punctuation\">.</span>supportsPersistence\nHostConfig<span class=\"token punctuation\">.</span>supportsHydration\n<span class=\"token comment\">// -------------------</span>\n<span class=\"token comment\">//      Mutation</span>\n<span class=\"token comment\">//     (optional)</span>\n<span class=\"token comment\">// -------------------</span>\nHostConfig<span class=\"token punctuation\">.</span>appendChild\nHostConfig<span class=\"token punctuation\">.</span>appendChildToContainer\nHostConfig<span class=\"token punctuation\">.</span>commitTextUpdate\nHostConfig<span class=\"token punctuation\">.</span>commitMount\nHostConfig<span class=\"token punctuation\">.</span>commitUpdate\nHostConfig<span class=\"token punctuation\">.</span>insertBefore\nHostConfig<span class=\"token punctuation\">.</span>insertInContainerBefore\nHostConfig<span class=\"token punctuation\">.</span>removeChild\nHostConfig<span class=\"token punctuation\">.</span>removeChildFromContainer\nHostConfig<span class=\"token punctuation\">.</span>resetTextContent\nHostConfig<span class=\"token punctuation\">.</span>hideInstance\nHostConfig<span class=\"token punctuation\">.</span>hideTextInstance\nHostConfig<span class=\"token punctuation\">.</span>unhideInstance\nHostConfig<span class=\"token punctuation\">.</span>unhideTextInstance\n<span class=\"token comment\">// -------------------</span>\n<span class=\"token comment\">//     Persistence</span>\n<span class=\"token comment\">//     (optional)</span>\n<span class=\"token comment\">// -------------------</span>\nHostConfig<span class=\"token punctuation\">.</span>cloneInstance\nHostConfig<span class=\"token punctuation\">.</span>createContainerChildSet\nHostConfig<span class=\"token punctuation\">.</span>appendChildToContainerChildSet\nHostConfig<span class=\"token punctuation\">.</span>finalizeContainerChildren\nHostConfig<span class=\"token punctuation\">.</span>replaceContainerChildren\nHostConfig<span class=\"token punctuation\">.</span>cloneHiddenInstance\nHostConfig<span class=\"token punctuation\">.</span>cloneUnhiddenInstance\nHostConfig<span class=\"token punctuation\">.</span>createHiddenTextInstance\n<span class=\"token comment\">// -------------------</span>\n<span class=\"token comment\">//     Hydration</span>\n<span class=\"token comment\">//     (optional)</span>\n<span class=\"token comment\">// -------------------</span>\nHostConfig<span class=\"token punctuation\">.</span>canHydrateInstance\nHostConfig<span class=\"token punctuation\">.</span>canHydrateTextInstance\nHostConfig<span class=\"token punctuation\">.</span>getNextHydratableSibling\nHostConfig<span class=\"token punctuation\">.</span>getFirstHydratableChild\nHostConfig<span class=\"token punctuation\">.</span>hydrateInstance\nHostConfig<span class=\"token punctuation\">.</span>hydrateTextInstance\nHostConfig<span class=\"token punctuation\">.</span>didNotMatchHydratedContainerTextInstance\nHostConfig<span class=\"token punctuation\">.</span>didNotMatchHydratedTextInstance\nHostConfig<span class=\"token punctuation\">.</span>didNotHydrateContainerInstance\nHostConfig<span class=\"token punctuation\">.</span>didNotHydrateInstance\nHostConfig<span class=\"token punctuation\">.</span>didNotFindHydratableContainerInstance\nHostConfig<span class=\"token punctuation\">.</span>didNotFindHydratableContainerTextInstance\nHostConfig<span class=\"token punctuation\">.</span>didNotFindHydratableInstance\nHostConfig<span class=\"token punctuation\">.</span>didNotFindHydratableTextInstance</code></pre></div>\n<br>\n&#x1F92C;Now, that looks like too much work &#x1F92F;. Fortunately, we only need to implement <strong>few of those functions</strong> to get the renderer up and running.&#x1F57A;&#x1F3FB;&#x1F47B;\n<div style=\"display:flex;flex-direction:row;align-items:center;\">\n<img src=\"/cea50333b91b753a26700da017172ff0/shocked.gif\" alt=\"shocked meme\" style=\"height:200px;margin:0 auto;\">\n</div>\n<p>I will try to explain what most of these methods do, but we will primarily focus on the ones we need. <strong>Disclaimer:</strong> Most of the content is a result of my experimentation with React renderers and reading through the publicly available source code and blog posts. Hence, if you find anything that needs correction, please do let me know in the comments.</p>\n<p><strong>Reconciler calls different functions from host config on the initial render phase as compared to whenever an update occurs via setState</strong>. Lets focus on initial render first.</p>\n<h2>Initial render</h2>\n<p>We are trying to render <strong>src/index.js</strong> that looks like this:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">const</span> <span class=\"token function-variable function\">Text</span> <span class=\"token operator\">=</span> <span class=\"token parameter\">props</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token operator\">&lt;</span>p className<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>props<span class=\"token punctuation\">.</span>className<span class=\"token punctuation\">}</span><span class=\"token operator\">></span><span class=\"token punctuation\">{</span>props<span class=\"token punctuation\">.</span>content<span class=\"token punctuation\">}</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>p<span class=\"token operator\">></span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">App</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token operator\">&lt;</span>div<span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span>Text className<span class=\"token operator\">=</span><span class=\"token string\">\"hello-class\"</span> content<span class=\"token operator\">=</span><span class=\"token string\">\"Hello\"</span> <span class=\"token operator\">/</span><span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span>span style<span class=\"token operator\">=</span><span class=\"token string\">\"color:blue;\"</span><span class=\"token operator\">></span>World<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>span<span class=\"token operator\">></span>\n    <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span>\n  <span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>So our rendered view tree should look like this:</p>\n<div style=\"display: block; max-width: 300px; margin: 0 auto;\"><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width:100% !important; max-width: 301px;\">\n      <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 129.90033222591362%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAaCAYAAAC3g3x9AAAACXBIWXMAAAsSAAALEgHS3X78AAADCElEQVRIx5VVa1PaQBTl//+NttNOP7RTOzrVtlMdx/qoImBBJRgghBAghryfuzndXQgkgFZ3OLObu/eePffuTaigMLIsE3OSJJhMJkuYpilQtMVxXIrJR2UbYRAEcBwHYRjC930MBgNomibs3Oa6rrC/mpDPPFCWZUiSJJ45Xk3I0+EpzmYzAU7ged7y+fHxEVEU/Z9wnZSnl5MbhoFkYcvJXqxw3SmKYgSMaN133e8JwhUpXQToIxWq0hVruiDKXqJwm1JqyQi7RwjkX6AzidnoVqJna5g7E0cB7R8D45oAVY5BrIeXp7w8WfwypOMGy/cKo9o+RvV9tq4i1a+ZD3lS5WYNCzWi5j2gniHongpgeA5qNMVeybdAXFmXnzuKBndZvym/Ae1cIFZO4Nvj/PhSTL6ubDPyYds2XM8HJRGI3UNqdZGlATw/hGVZW8n4XFmvBSGJCAjX+q7Ul3EEa2YhTchGZywVUpphMgtwVm2xgLR0+lJFQQ2lBBf1M2imynqTlBUmKcWDHqM1TAQkPUEYb97k8vOWxpCmd2hoNdQZ7sctxGm0uhTN5GQp2voctxqBMo0XhS8r5UO1FNSG17gZNtBgqA9rUMxuTpihN4nRHmeoyxYu7w1IEwjFlNK11OdKZaODv6MbfD3ewc7RF0HYMdorhVM7QVNNmDoCaUzYOsXIjLfXkY2JqzOFVbT0JlosXb4e2cNyH2omq58aMbIIAyMWl/RUDfnM0+Y1bLDUB7M+uxhauOWFo2W7As81bvEAx3NgWmbuPr/lorPPvsq+7y0C6Uazr1KfqxH/L45b8l+kPA/wvPmbULRte4vyZRBGcFyvZKuQhJ1AA6F5Ou5DH8q8bdljCJp4SzW5Cpr6Yo/7mFMVw4G0yDdgex4qdHYKo3+IXnNXYNQ5gCYxtA+Q2VcgibMk5GTEYjfa+c5899Bv7WIs/4Byuwf94ScS4wSVdHIAtfUJtxdvcPfnLXqNjwKd6nukxiFIbK3ec6Y4mR5Brn1g/m9FjHb3Ge3Ld+iymHD0Df8ARbDcCSkMjUEAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"first render tree\" title=\"first render tree\" src=\"/static/115619b0764ce71806ab6bee7e8ae2b7/8e7b9/first_render_view_tree.png\" srcset=\"/static/115619b0764ce71806ab6bee7e8ae2b7/9ec3c/first_render_view_tree.png 200w,\n/static/115619b0764ce71806ab6bee7e8ae2b7/8e7b9/first_render_view_tree.png 301w\" sizes=\"(max-width: 301px) 100vw, 301px\" loading=\"lazy\">\n    </span></div>\n<p>Now lets look at the error that we got earlier: <span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width:100% !important; max-width: 800px;\"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 35.29411764705882%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAABYlAAAWJQFJUiTwAAABAUlEQVQoz5WQa2vCMBiF+///2ZjuhjBwbJ3VWG16sW2a0tyepTph33QvPJwQDue8STJkO0aRY8sKU5RnpvyImww+BELk3jHWkkgpOdU1fd/Tdj0qMqmBSWvMOOKNAecI0XyL2ZdUaUqzWrF+XLBePiFe3mjTb2xVYdsWezqd1cfCmwwDSbnZ0MXQ4isl//ykybbILEPudjT7PeV2Sy0EOhaMkVl1WTLEl7muIyiFV5fAMAeqXtHHSzuvfJ3523z41cvZO09wF70SZk8k/CFRqqY6CJqiwEyxLYw4r8/4SAj/YSTR7TuNeEAelsjjgla+UufPVGKJ7j5i6AFn93fhXcEPG/McguykFE4AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"now error\"\n        title=\"now error\"\n        src=\"/static/e4cf725cd4373440712b73c54227f736/8ff1e/first_error_now.png\"\n        srcset=\"/static/e4cf725cd4373440712b73c54227f736/9ec3c/first_error_now.png 200w,\n/static/e4cf725cd4373440712b73c54227f736/c7805/first_error_now.png 400w,\n/static/e4cf725cd4373440712b73c54227f736/8ff1e/first_error_now.png 800w,\n/static/e4cf725cd4373440712b73c54227f736/6ff5e/first_error_now.png 1200w,\n/static/e4cf725cd4373440712b73c54227f736/2f950/first_error_now.png 1600w,\n/static/e4cf725cd4373440712b73c54227f736/9a042/first_error_now.png 2040w\"\n        sizes=\"(max-width: 800px) 100vw, 800px\"\n        loading=\"lazy\"\n      />\n    </span> <br/>\nFrom the list of functions in the hostConfig lets implement <strong>now()</strong>.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">const</span> HostConfig <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  now<span class=\"token punctuation\">:</span> Date<span class=\"token punctuation\">.</span>now<span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><strong>now</strong> is used by the reconciler to calculate the current time. Hence we will provide it <strong>Date.now</strong>.</p>\n<p>Refresh! and we get : <span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width:100% !important; max-width: 800px;\"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 21.847070506454816%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAYAAACOXx+WAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAqElEQVQY042NXW6DMBAGuf/9mjateGgwoQI7+G+xAsTTDQdIu9Jonna+psbE/WdEJksyV9J1YLvN7D7yyMI+B/aUqUCt9U8a0eeb6VmsOyKbD6yz5+49q46tGqxL4b/XSIxMw4C3luDs4exmog5E5xANlxAo6l2EWspLGtHA+HZiPH8yvH8cnk5fuHOLa1vi9wXpDOmiNobS92T1on4iXcemwzVnHinxCyA4M5OXfq8IAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"get root host error\"\n        title=\"get root host error\"\n        src=\"/static/f9e036c66ed30e81c2952aa8298bcdfe/8ff1e/get_root_host_not_function.png\"\n        srcset=\"/static/f9e036c66ed30e81c2952aa8298bcdfe/9ec3c/get_root_host_not_function.png 200w,\n/static/f9e036c66ed30e81c2952aa8298bcdfe/c7805/get_root_host_not_function.png 400w,\n/static/f9e036c66ed30e81c2952aa8298bcdfe/8ff1e/get_root_host_not_function.png 800w,\n/static/f9e036c66ed30e81c2952aa8298bcdfe/6ff5e/get_root_host_not_function.png 1200w,\n/static/f9e036c66ed30e81c2952aa8298bcdfe/2f950/get_root_host_not_function.png 1600w,\n/static/f9e036c66ed30e81c2952aa8298bcdfe/eccb6/get_root_host_not_function.png 2014w\"\n        sizes=\"(max-width: 800px) 100vw, 800px\"\n        loading=\"lazy\"\n      />\n    </span>\nLets stub this function</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">const</span> HostConfig <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  now<span class=\"token punctuation\">:</span> Date<span class=\"token punctuation\">.</span>now<span class=\"token punctuation\">,</span>\n  <span class=\"token function-variable function\">getRootHostContext</span><span class=\"token punctuation\">:</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token operator\">...</span>args</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'getRootHostContext'</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">...</span>args<span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Refresh! and we get: <span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width:100% !important; max-width: 800px;\"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 24.400000000000002%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAy0lEQVQY04XO227DIAwGYN7/6TatzdKbVVoItNkSIJCSA/DXbpW7akP6ZCOMbbFcrgjdL7xUsN8SW2+QjENyI5IdsRmLkjP4lFL+JUyrMfMn55FJsg4bo4Ys+/Bstjfc8xf4iF4puLaFVhpX/WT6/sENA27eYwkBZZ6BdQGWF9b18V5ihLB1jeF4RHOoID8OOL+9Q1UV9GeNC+nqE8zXGaFpEGnwRHGSEjfC+R43Gl5osPC0ERfG7geRtmJ5HFFos12ie3LuT5lrpwl3P8t/4l2CeAAAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"get child host error\"\n        title=\"get child host error\"\n        src=\"/static/64adb84c3fff67aaa2d7f9a2216e3f4d/8ff1e/get_child_host_error.png\"\n        srcset=\"/static/64adb84c3fff67aaa2d7f9a2216e3f4d/9ec3c/get_child_host_error.png 200w,\n/static/64adb84c3fff67aaa2d7f9a2216e3f4d/c7805/get_child_host_error.png 400w,\n/static/64adb84c3fff67aaa2d7f9a2216e3f4d/8ff1e/get_child_host_error.png 800w,\n/static/64adb84c3fff67aaa2d7f9a2216e3f4d/6ff5e/get_child_host_error.png 1200w,\n/static/64adb84c3fff67aaa2d7f9a2216e3f4d/2f950/get_child_host_error.png 1600w,\n/static/64adb84c3fff67aaa2d7f9a2216e3f4d/d40c8/get_child_host_error.png 2000w\"\n        sizes=\"(max-width: 800px) 100vw, 800px\"\n        loading=\"lazy\"\n      />\n    </span></p>\n<p>Continuing the chain till we have no more errors we get:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">const</span> HostConfig <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  now<span class=\"token punctuation\">:</span> Date<span class=\"token punctuation\">.</span>now<span class=\"token punctuation\">,</span>\n  <span class=\"token function-variable function\">getRootHostContext</span><span class=\"token punctuation\">:</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token operator\">...</span>args</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'getRootHostContext'</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">...</span>args<span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token function-variable function\">getChildHostContext</span><span class=\"token punctuation\">:</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token operator\">...</span>args</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'getChildHostContext'</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">...</span>args<span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token function-variable function\">shouldSetTextContent</span><span class=\"token punctuation\">:</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token operator\">...</span>args</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'shouldSetTextContent'</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">...</span>args<span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token function-variable function\">createTextInstance</span><span class=\"token punctuation\">:</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token operator\">...</span>args</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'createTextInstance'</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">...</span>args<span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token function-variable function\">createInstance</span><span class=\"token punctuation\">:</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token operator\">...</span>args</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'createInstance'</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">...</span>args<span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token function-variable function\">appendInitialChild</span><span class=\"token punctuation\">:</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token operator\">...</span>args</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'appendInitialChild'</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">...</span>args<span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token function-variable function\">finalizeInitialChildren</span><span class=\"token punctuation\">:</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token operator\">...</span>args</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'finalizeInitialChildren'</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">...</span>args<span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token function-variable function\">prepareForCommit</span><span class=\"token punctuation\">:</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token operator\">...</span>args</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'prepareForCommit'</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">...</span>args<span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token function-variable function\">resetAfterCommit</span><span class=\"token punctuation\">:</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token operator\">...</span>args</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'resetAfterCommit'</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">...</span>args<span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Now we should get a blank screen, but our logs should help us figure out what the reconciler is trying to do and in what order these functions are getting called.\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width:100% !important; max-width: 800px;\"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 27.044854881266488%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAABYlAAAWJQFJUiTwAAAA1ElEQVQY032PyW7DMAxE/f9/acNu4miXqM3bhFLqouihBAaci54eByElvh5PWGNhpUH0Eedx4r+5rqvn7m1qrViWBYNUGo/nCq0U/EvAK4OgNch5JMqIMcJzjzH1nlPCtm09pRSc5+fz1ud5xrAyZJoXCCFhOU4okDZIIaCmwoDSYe1Bg+ycBjmOA/u+/xjmnDGOIwalP4aGd2Bbsh7E54dmxedTIDjnEIlAnMy54X8N+8nrS3agEAKKgdEHJE+8CYHhkRJqqdi+Ib9Bze4GNsNpmvAGA1eChztPe/4AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"initial render logs list\"\n        title=\"initial render logs list\"\n        src=\"/static/b3372028ced105244dde31d90e7f2aca/8ff1e/initial_render_logs_list.png\"\n        srcset=\"/static/b3372028ced105244dde31d90e7f2aca/9ec3c/initial_render_logs_list.png 200w,\n/static/b3372028ced105244dde31d90e7f2aca/c7805/initial_render_logs_list.png 400w,\n/static/b3372028ced105244dde31d90e7f2aca/8ff1e/initial_render_logs_list.png 800w,\n/static/b3372028ced105244dde31d90e7f2aca/6ff5e/initial_render_logs_list.png 1200w,\n/static/b3372028ced105244dde31d90e7f2aca/2f950/initial_render_logs_list.png 1600w,\n/static/b3372028ced105244dde31d90e7f2aca/0ac08/initial_render_logs_list.png 3032w\"\n        sizes=\"(max-width: 800px) 100vw, 800px\"\n        loading=\"lazy\"\n      />\n    </span>\n<em>(Right Click on the image and select <strong>Open Image in New Tab</strong> to get a better resolution version).</em></p>\n<p>The order of execution looks like this:</p>\n<a target=\"_blank\" href=\"/d5cdb43d6edb0b0c33429306692d175/d5cdb43d6edb0b0c33429306692d175e/inital_render_tree_flow.svg\">\n  <img src=\"/d5cdb43d6edb0b0c33429306692d175/d5cdb43d6edb0b0c33429306692d175e/inital_render_tree_flow.svg\" alt=\"inital render flow\" style=\"margin: 0 auto;display: block;\">\n</a>\n<br>\n<p>Now we should be able to guess what these methods do. But instead of just making wild guesses, It is a good idea to read through <a href='https://github.com/facebook/react/blob/409e472fcaae2b6c171f4e9a0c4b5ad88ec2bf21/packages/react-dom/src/client/ReactDOMHostConfig.js#L97' target='_blank'>the source code of <strong>react-dom</strong> to </a> better understand what each of these functions are doing.</p>\n<h3>‚ñ∏ now</h3>\n<hr>\n<p>This function is used by the reconciler in order to calculate current time for prioritising work. In case of <strong>react-dom</strong>, it uses <strong>performace.now</strong> if available or it falls back to <strong>Date.now</strong>\nHence, lets just keep it as <strong>Date.now</strong> for our custom renderer.</p>\n<h3>‚ñ∏ getRootHostContext</h3>\n<hr>\n<p>The function signature is:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">function</span> <span class=\"token function\">getRootHostContext</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">nextRootInstance</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">let</span> context <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// This can contain any data that you want to pass down to immediate child</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token keyword\">return</span> context\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><strong><em>Parameters</em></strong></p>\n<ul>\n<li><strong>nextRootInstance</strong>: nextRootInstance is basically the root dom node you specify while calling render. This is most commonly <code class=\"language-text\">&lt;div id=&quot;root&quot;&gt;&lt;/div&gt;</code></li>\n</ul>\n<p><strong><em>Return Value</em></strong> A context object that you wish to pass to immediate child.</p>\n<p><strong><em>Purpose</em></strong></p>\n<p>This function lets you share some context with the other functions in this HostConfig.</p>\n<p><strong><em>For our custom renderer</em></strong></p>\n<p>Hence in our case lets just return a blank object as show above.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token function-variable function\">getRootHostContext</span><span class=\"token punctuation\">:</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">nextRootInstance</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">let</span> rootContext <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\n  <span class=\"token keyword\">return</span> rootContext\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h3>‚ñ∏ getChildHostContext</h3>\n<hr>\n<p>The function signature is:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">function</span> <span class=\"token function\">getChildHostContext</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">parentContext<span class=\"token punctuation\">,</span> fiberType<span class=\"token punctuation\">,</span> rootInstance</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">let</span> context <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// This can contain any data that you want to pass down to immediate child</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token keyword\">return</span> context\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><strong><em>Parameters</em></strong></p>\n<ul>\n<li><strong>parentContext</strong>: Context from parent. Example: This will contain rootContext for the immediate child of roothost.</li>\n<li><strong>rootInstance</strong>: rootInstance is basically the root dom node you specify while calling render. This is most commonly <code class=\"language-text\">&lt;div id=&quot;root&quot;&gt;&lt;/div&gt;</code></li>\n<li><strong>fiberType</strong>: This contains the type of fiber i.e, ‚Äòdiv‚Äô, ‚Äòspan‚Äô, ‚Äòp‚Äô, ‚Äòinput‚Äô etc.</li>\n</ul>\n<p><strong><em>Return Value</em></strong> A context object that you wish to pass to immediate child.</p>\n<p><strong><em>Purpose</em></strong></p>\n<p>This function provides a way to access context from the parent and also a way to pass some context to the immediate children of the current node. Context is basically a regular object containing some information.</p>\n<p><strong><em>For our custom renderer</em></strong></p>\n<p>Hence in our case lets just return a blank object as show above.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token function-variable function\">getChildHostContext</span><span class=\"token punctuation\">:</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">parentContext<span class=\"token punctuation\">,</span> fiberType<span class=\"token punctuation\">,</span> rootInstance</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">let</span> context <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\n  <span class=\"token keyword\">return</span> context\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h3>‚ñ∏ shouldSetTextContent</h3>\n<hr>\n<p>The function signature is:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">function</span> <span class=\"token function\">shouldSetTextContent</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">type<span class=\"token punctuation\">,</span> nextProps</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> Boolean\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><strong><em>Parameters</em></strong></p>\n<ul>\n<li><strong>nextProps</strong>: Contains the props passed to the host react element.</li>\n<li><strong>type</strong>: This contains the type of fiber i.e, ‚Äòdiv‚Äô, ‚Äòspan‚Äô, ‚Äòp‚Äô, ‚Äòinput‚Äô etc.</li>\n</ul>\n<p><strong><em>Return Value</em></strong> This should be a boolean value.</p>\n<p><strong><em>Purpose</em></strong></p>\n<p>If the function returns true, the text would be created inside the host element and no new text element would be created separately.</p>\n<p>If this returned true, the next call would be to <strong>createInstance</strong> for the current element and traversal would stop at this node (children of this element wont be traversed).</p>\n<p>If it returns false, <strong>getChildHostContext</strong> and <strong>shouldSetTextContent</strong> will be called on the child elements and it will continue till shouldSetTextContent returns true or if the recursion reaches the last tree endpoint which usually is a text node. When it reaches the last leaf text node it will call <strong>createTextInstance</strong></p>\n<p>In case of react-dom the implementation is as follows:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">return</span> type <span class=\"token operator\">===</span> <span class=\"token string\">'textarea'</span> <span class=\"token operator\">||</span>\ntype <span class=\"token operator\">===</span> <span class=\"token string\">'option'</span> <span class=\"token operator\">||</span>\ntype <span class=\"token operator\">===</span> <span class=\"token string\">'noscript'</span> <span class=\"token operator\">||</span>\n<span class=\"token keyword\">typeof</span> props<span class=\"token punctuation\">.</span>children <span class=\"token operator\">===</span> <span class=\"token string\">'string'</span> <span class=\"token operator\">||</span>\n<span class=\"token keyword\">typeof</span> props<span class=\"token punctuation\">.</span>children <span class=\"token operator\">===</span> <span class=\"token string\">'number'</span> <span class=\"token operator\">||</span>\n<span class=\"token punctuation\">(</span><span class=\"token keyword\">typeof</span> props<span class=\"token punctuation\">.</span>dangerouslySetInnerHTML <span class=\"token operator\">===</span> <span class=\"token string\">'object'</span> <span class=\"token operator\">&amp;&amp;</span>\nprops<span class=\"token punctuation\">.</span>dangerouslySetInnerHTML <span class=\"token operator\">!==</span> <span class=\"token keyword\">null</span> <span class=\"token operator\">&amp;&amp;</span>\nprops<span class=\"token punctuation\">.</span>dangerouslySetInnerHTML<span class=\"token punctuation\">.</span>\\_\\_html <span class=\"token operator\">!=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>So for these elements react-dom renderer doesn‚Äôt create a separate text instance in the renderer.</p>\n<p><strong><em>For our custom renderer</em></strong></p>\n<p>For our case, lets set it to false, so that we get an instance even for text.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token function-variable function\">shouldSetTextContent</span><span class=\"token punctuation\">:</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">type<span class=\"token punctuation\">,</span> nextProps</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token boolean\">false</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h3>‚ñ∏ createTextInstance</h3>\n<hr>\n<p>The function signature is:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">function</span> <span class=\"token function\">createTextInstance</span><span class=\"token punctuation\">(</span>\n  <span class=\"token parameter\">newText<span class=\"token punctuation\">,</span>\n  rootContainerInstance<span class=\"token punctuation\">,</span>\n  currentHostContext<span class=\"token punctuation\">,</span>\n  workInProgress</span>\n<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> textNode\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><strong><em>Parameters</em></strong></p>\n<ul>\n<li><strong>newText</strong>: contains the text string that needs to be rendered.</li>\n<li><strong>rootContainerInstance</strong>: root dom node you specify while calling render. This is most commonly <code class=\"language-text\">&lt;div id=&quot;root&quot;&gt;&lt;/div&gt;</code></li>\n<li><strong>currentHostContext</strong>: contains the context from the host node enclosing this text node. For example, in the case of <code class=\"language-text\">&lt;p&gt;Hello&lt;/p&gt;</code>: currentHostContext for <strong>Hello</strong> text node will be host context of <code class=\"language-text\">p</code>.</li>\n<li><strong>workInProgress</strong>: The fiber node for the text instance. This manages work for this instance.</li>\n</ul>\n<p><strong><em>Return Value</em></strong> This should be an actual text view element. In case of dom it would be a textNode.</p>\n<p><strong><em>Purpose</em></strong></p>\n<p>Here we specify how should renderer handle the text content</p>\n<p><strong><em>For our custom renderer</em></strong></p>\n<p>Lets just create a simple text node and return it.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token function-variable function\">createTextInstance</span><span class=\"token punctuation\">:</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span>\n  <span class=\"token parameter\">newText<span class=\"token punctuation\">,</span>\n  rootContainerInstance<span class=\"token punctuation\">,</span>\n  currentHostContext<span class=\"token punctuation\">,</span>\n  workInProgress</span>\n<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">createTextNode</span><span class=\"token punctuation\">(</span>newText<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<hr>\n<p>The reconciler is currently at the leaf text node in our traversal. Once it finishes text creation operation, it will move back up and call <strong>createInstance</strong> on the enclosing element.</p>\n<h3>‚ñ∏ createInstance</h3>\n<hr>\n<p>The function signature is:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">function</span> <span class=\"token function\">createInstance</span><span class=\"token punctuation\">(</span>\n  <span class=\"token parameter\">type<span class=\"token punctuation\">,</span>\n  newProps<span class=\"token punctuation\">,</span>\n  rootContainerInstance<span class=\"token punctuation\">,</span>\n  currentHostContext<span class=\"token punctuation\">,</span>\n  workInProgress</span>\n<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> domElement\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><strong><em>Parameters</em></strong></p>\n<ul>\n<li><strong>type</strong>: This contains the type of fiber i.e, ‚Äòdiv‚Äô, ‚Äòspan‚Äô, ‚Äòp‚Äô, ‚Äòinput‚Äô etc.</li>\n<li><strong>nextProps</strong>: Contains the props passed to the host react element.</li>\n<li><strong>rootContainerInstance</strong>: root dom node you specify while calling render. This is most commonly <code class=\"language-text\">&lt;div id=&quot;root&quot;&gt;&lt;/div&gt;</code></li>\n<li><strong>currentHostContext</strong>: contains the context from the parent node enclosing this node. This is the return value from <strong>getChildHostContext</strong> of the parent node.</li>\n<li><strong>workInProgress</strong>: The fiber node for the text instance. This manages work for this instance.</li>\n</ul>\n<p><strong><em>Return Value</em></strong> This should be an actual dom element for the node.</p>\n<p><strong><em>Purpose</em></strong></p>\n<p>Create instance is called on all <strong>host</strong> nodes except the leaf text nodes. So we should return the correct view element for each host type here. We are also supposed to take care of the props sent to the host element. For example: setting up onClickListeners or setting up styling etc.</p>\n<p><strong><em>For our custom renderer</em></strong></p>\n<p>Lets just create the appropriate dom element and add all the attributes from the react element.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token function-variable function\">createInstance</span><span class=\"token punctuation\">:</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span>\n  <span class=\"token parameter\">type<span class=\"token punctuation\">,</span>\n  newProps<span class=\"token punctuation\">,</span>\n  rootContainerInstance<span class=\"token punctuation\">,</span>\n  currentHostContext<span class=\"token punctuation\">,</span>\n  workInProgress</span>\n<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> element <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">createElement</span><span class=\"token punctuation\">(</span>type<span class=\"token punctuation\">)</span>\n  element<span class=\"token punctuation\">.</span>className <span class=\"token operator\">=</span> newProps<span class=\"token punctuation\">.</span>className <span class=\"token operator\">||</span> <span class=\"token string\">''</span>\n  element<span class=\"token punctuation\">.</span>style <span class=\"token operator\">=</span> newProps<span class=\"token punctuation\">.</span>style\n  <span class=\"token comment\">// ....</span>\n  <span class=\"token comment\">// ....</span>\n  <span class=\"token comment\">// if (newProps.onClick) {</span>\n  <span class=\"token comment\">//   element.addEventListener('click', newProps.onClick)</span>\n  <span class=\"token comment\">// }</span>\n  <span class=\"token keyword\">return</span> element\n<span class=\"token punctuation\">}</span></code></pre></div>\n<hr>\n<p>At this point it is important to understand that we are coming back up from recursion. So all child nodes have been instantiated and created. Hence, right after creating instance, we will need to attach the children to this node and that will be done in <strong>appendInitialChild</strong>.</p>\n<h3>‚ñ∏ appendInitialChild</h3>\n<hr>\n<p>The function signature is:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">function</span> <span class=\"token function\">appendInitialChild</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">parent<span class=\"token punctuation\">,</span> child</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span></code></pre></div>\n<p><strong><em>Parameters</em></strong></p>\n<ul>\n<li><strong>parent</strong>: The current node in the traversal</li>\n<li><strong>child</strong>: The child dom node of the current node.</li>\n</ul>\n<p><strong><em>Purpose</em></strong></p>\n<p>Here we will attach the child dom node to the parent on the initial render phase. This method will be called for each child of the current node.</p>\n<p><strong><em>For our custom renderer</em></strong></p>\n<p>We will go ahead and attach the child nodes to the parent dom node.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token function-variable function\">appendInitialChild</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">parent<span class=\"token punctuation\">,</span> child</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  parent<span class=\"token punctuation\">.</span><span class=\"token function\">appendChild</span><span class=\"token punctuation\">(</span>child<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h3>‚ñ∏ finalizeInitialChildren</h3>\n<hr>\n<p>The function signature is:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">function</span> <span class=\"token function\">finalizeInitialChildren</span><span class=\"token punctuation\">(</span>\n  <span class=\"token parameter\">instance<span class=\"token punctuation\">,</span>\n  type<span class=\"token punctuation\">,</span>\n  newProps<span class=\"token punctuation\">,</span>\n  rootContainerInstance<span class=\"token punctuation\">,</span>\n  currentHostContext</span>\n<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> Boolean\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><strong><em>Parameters</em></strong></p>\n<ul>\n<li><strong>instance</strong>: The instance is the dom element after appendInitialChild.</li>\n<li><strong>type</strong>: This contains the type of fiber i.e, ‚Äòdiv‚Äô, ‚Äòspan‚Äô, ‚Äòp‚Äô, ‚Äòinput‚Äô etc.</li>\n<li><strong>newProps</strong>: Contains the props passed to the host react element.</li>\n<li><strong>rootContainerInstance</strong>: root dom node you specify while calling render. This is most commonly <code class=\"language-text\">&lt;div id=&quot;root&quot;&gt;&lt;/div&gt;</code></li>\n<li><strong>currentHostContext</strong>: contains the context from the parent node enclosing this node. This is the return value from <strong>getChildHostContext</strong> of the parent node.</li>\n</ul>\n<p><strong><em>Return Value</em></strong> A boolean value which decides if <strong>commitMount</strong> for this element needs to be called.</p>\n<p><strong><em>Purpose</em></strong></p>\n<p>In case of react native renderer, this function does nothing but return false.</p>\n<p>In case of react-dom, this adds default dom properties such as event listeners, etc. For implementing auto focus for certain input elements (autofocus can happen only after render is done), react-dom sends return type as true. This results in <strong>commitMount</strong> method for this element to be called. The commitMount will be called only if an element returns true in finalizeInitialChildren and after the all elements of the tree has been rendered (even after resetAfterCommit).</p>\n<p><strong><em>For our custom renderer</em></strong></p>\n<p>We can return false in our case. But for experimental purpose, lets return true if autofocus is set to true. Make sure you implement a stub method for <strong>commitMount</strong> in hostConfig if you return true.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token function-variable function\">finalizeInitialChildren</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">(</span>\n  <span class=\"token parameter\">instance<span class=\"token punctuation\">,</span>\n  type<span class=\"token punctuation\">,</span>\n  newProps<span class=\"token punctuation\">,</span>\n  rootContainerInstance<span class=\"token punctuation\">,</span>\n  currentHostContext</span>\n<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> newProps<span class=\"token punctuation\">.</span>autofocus <span class=\"token comment\">//simply return true for experimenting</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<hr>\n<p>Now once all the child instances are done and finalised. Reconciler will move up the recursion to the parent of this node. Remember that the parent of the current node hasn‚Äôt been instantiated yet. So the reconciler will go up and call <strong>createInstance</strong> ‚Üí <strong>appendInitialChild</strong> ‚Üí <strong>finalizeInitialChildren</strong> on the parent. This cycle will happen till we reach the top of the recursion tree. When no more elements are left then <strong>prepareForCommit</strong> will be invoked.</p>\n<h3>‚ñ∏ prepareForCommit</h3>\n<hr>\n<p>The function signature is:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">function</span> <span class=\"token function\">prepareForCommit</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">rootContainerInstance</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span></code></pre></div>\n<p><strong><em>Parameters</em></strong></p>\n<ul>\n<li><strong>rootContainerInstance</strong>: root dom node you specify while calling render. This is most commonly <code class=\"language-text\">&lt;div id=&quot;root&quot;&gt;&lt;/div&gt;</code></li>\n</ul>\n<p><strong><em>Purpose</em></strong></p>\n<p>This function is called when we have made a in-memory render tree of all the views (Remember we are yet to attach it the the actual root dom node).\nHere we can do any preparation that needs to be done on the rootContainer before attaching the in memory render tree.\nFor example: In the case of react-dom, it keeps track of all the currently focused elements, disabled events temporarily, etc.</p>\n<p><strong><em>For our custom renderer</em></strong></p>\n<p>Since we are aiming at a simple renderer, this will be a no-op for us.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token function-variable function\">prepareForCommit</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">rootContainerInstance</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span></code></pre></div>\n<hr>\n<p>After prepareForCommit, the reconciler will commit the in memory tree to the rootHost following which the browser will trigger repaint.</p>\n<h3>‚ñ∏ resetAfterCommit</h3>\n<hr>\n<p>The function signature is:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">function</span> <span class=\"token function\">resetAfterCommit</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">rootContainerInstance</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span></code></pre></div>\n<p><strong><em>Parameters</em></strong></p>\n<ul>\n<li><strong>rootContainerInstance</strong>: root dom node you specify while calling render. This is most commonly <code class=\"language-text\">&lt;div id=&quot;root&quot;&gt;&lt;/div&gt;</code></li>\n</ul>\n<p><strong><em>Purpose</em></strong></p>\n<p>This function gets executed after the inmemory tree has been attached to the root dom element. Here we can do any post attach operations that needs to be done. For example: react-dom re-enabled events which were temporarily disabled in prepareForCommit and refocuses elements, etc.</p>\n<p><strong><em>For our custom renderer</em></strong></p>\n<p>Since we are aiming at a simple renderer, this will be a no-op for us.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token function-variable function\">resetAfterCommit</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">rootContainerInstance</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span></code></pre></div>\n<br/>\n<hr>\n<p>Now after this, we expect our document to be rendererd but it <span style=\"color:red; font-weight:bold;\">DOES NOT</span>.\nThe issue is we dont have code that tells how to append our in-memory tree to the root div. The answer to this is <strong>appendChildToContainer</strong></p>\n<h3>‚ñ∏ appendChildToContainer</h3>\n<hr>\n<p>The function signature is:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">function</span> <span class=\"token function\">appendChildToContainer</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">parent<span class=\"token punctuation\">,</span> child</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span></code></pre></div>\n<p><strong><em>Parameters</em></strong></p>\n<ul>\n<li><strong>parent</strong>: The root div or the container.</li>\n<li><strong>child</strong>: The child dom node tree or the in-memory tree.</li>\n</ul>\n<p><strong><em>Purpose</em></strong></p>\n<p>Here we will our in-memory tree to the root host div. But this function only works if we set <span style=\"color:blue; font-weight:bold;\">supportsMutation:true</span>.</p>\n<p><strong><em>For our custom renderer</em></strong></p>\n<p>We will go ahead and attach the child nodes to the root dom node.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token function-variable function\">appendChildToContainer</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">parent<span class=\"token punctuation\">,</span> child</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  parent<span class=\"token punctuation\">.</span><span class=\"token function\">appendChild</span><span class=\"token punctuation\">(</span>child<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\nsupportsMutation<span class=\"token punctuation\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span></code></pre></div>\n<h2>Demo</h2>\n<p>Now, lets refresh our React App!</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width:100% !important; max-width: 800px;\"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 27.042577675489067%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAaElEQVQY062O2wqAIBBE/f/PLCQKxLxl4uqkkhD0Zg0Me/bCMiyEAO9PWOsgd4Vp5uDLWlhDGwdlbLO+qyl3znu44+HS13nds22TIEqoyjkXJlBKjUfMhCDEmPGXWIfRRK+EHfrTr7oAQP+Ks1LKR1gAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"working inital render\"\n        title=\"working inital render\"\n        src=\"/static/3fdfaf2dc3871c4ad0d021208902d6eb/8ff1e/working-initial-render.png\"\n        srcset=\"/static/3fdfaf2dc3871c4ad0d021208902d6eb/9ec3c/working-initial-render.png 200w,\n/static/3fdfaf2dc3871c4ad0d021208902d6eb/c7805/working-initial-render.png 400w,\n/static/3fdfaf2dc3871c4ad0d021208902d6eb/8ff1e/working-initial-render.png 800w,\n/static/3fdfaf2dc3871c4ad0d021208902d6eb/6ff5e/working-initial-render.png 1200w,\n/static/3fdfaf2dc3871c4ad0d021208902d6eb/2f950/working-initial-render.png 1600w,\n/static/3fdfaf2dc3871c4ad0d021208902d6eb/4033a/working-initial-render.png 1738w\"\n        sizes=\"(max-width: 800px) 100vw, 800px\"\n        loading=\"lazy\"\n      />\n    </span></p>\n<hr>\n<p>Holy!!! We just built our very own mini React üòéüéâüéäü§ü</p>\n<div style=\"display:flex;flex-direction:row;align-items:center;\">\n<img src=\"/8ee9b82cfa2532bd5c18e832815fdafe/hell_yeah.gif\" alt=\"hell yeah\" style=\"height:200px;margin:0 auto;\">\n</div>\n<h2>Before we finish</h2>\n<p>lets implement <strong>commitMount</strong> also.</p>\n<h3>‚ñ∏ commitMount</h3>\n<hr>\n<p>The function signature is:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">function</span> <span class=\"token function\">commitMount</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">domElement<span class=\"token punctuation\">,</span> type<span class=\"token punctuation\">,</span> newProps<span class=\"token punctuation\">,</span> fiberNode</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span></code></pre></div>\n<p><strong><em>Parameters</em></strong></p>\n<ul>\n<li><strong>domElement</strong>: The rendered, attached dom element for this react element.</li>\n<li><strong>type</strong>: This contains the type of fiber i.e, ‚Äòdiv‚Äô, ‚Äòspan‚Äô, ‚Äòp‚Äô, ‚Äòinput‚Äô etc.</li>\n<li><strong>newProps</strong>: Contains the props passed to the host react element.</li>\n<li><strong>fiberNode</strong>: The fiber node for the element. This manages work for this instance.</li>\n</ul>\n<p><strong><em>Purpose</em></strong></p>\n<p>This function is called for every element that has set the return value of <strong>finalizeInitialChildren</strong> to true.\nThis method is called after all the steps are done (ie after resetAfterCommit), meaning the entire tree has been attached to the dom. This method is mainly used in react-dom for implementing autofocus. This method exists in react-dom only and not in react-native.</p>\n<p>According to a comment in react-dom source code.</p>\n<blockquote>\n<p>Despite the naming that might imply otherwise, this method only\nfires if there is an <code class=\"language-text\">Update</code> effect scheduled during mounting.\nThis happens if <code class=\"language-text\">finalizeInitialChildren</code> returns <code class=\"language-text\">true</code> (which it\ndoes to implement the <code class=\"language-text\">autoFocus</code> attribute on the client). But\nthere are also other cases when this might happen (such as patching\nup text content during hydration mismatch).</p>\n</blockquote>\n<p><strong><em>For our custom renderer</em></strong></p>\n<p>We will go ahead and call focus on the dom element.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token function-variable function\">commitMount</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">domElement<span class=\"token punctuation\">,</span> type<span class=\"token punctuation\">,</span> newProps<span class=\"token punctuation\">,</span> fiberNode</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n   domElement<span class=\"token punctuation\">.</span><span class=\"token function\">focus</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span></code></pre></div>\n<br>\n<p><strong><a href='https://github.com/master-atul/blog-custom-renderer/tree/31d5ff827565ef8f4f8e5061b97c16ec3b6a279f' target='_blank'>Link to source code till here</a></strong></p>\n<br>\n<p>Our HostConfig looks like this now:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">const</span> HostConfig <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  now<span class=\"token punctuation\">:</span> Date<span class=\"token punctuation\">.</span>now<span class=\"token punctuation\">,</span>\n  <span class=\"token function-variable function\">getRootHostContext</span><span class=\"token punctuation\">:</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">nextRootInstance</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">let</span> rootContext <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\n    <span class=\"token keyword\">return</span> rootContext\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token function-variable function\">getChildHostContext</span><span class=\"token punctuation\">:</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">parentContext<span class=\"token punctuation\">,</span> fiberType<span class=\"token punctuation\">,</span> rootInstance</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">let</span> context <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span> type<span class=\"token punctuation\">:</span> fiberType <span class=\"token punctuation\">}</span>\n    <span class=\"token keyword\">return</span> context\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token function-variable function\">shouldSetTextContent</span><span class=\"token punctuation\">:</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">type<span class=\"token punctuation\">,</span> nextProps</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token boolean\">false</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token function-variable function\">createTextInstance</span><span class=\"token punctuation\">:</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span>\n    <span class=\"token parameter\">newText<span class=\"token punctuation\">,</span>\n    rootContainerInstance<span class=\"token punctuation\">,</span>\n    currentHostContext<span class=\"token punctuation\">,</span>\n    workInProgress</span>\n  <span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">createTextNode</span><span class=\"token punctuation\">(</span>newText<span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token function-variable function\">createInstance</span><span class=\"token punctuation\">:</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span>\n    <span class=\"token parameter\">type<span class=\"token punctuation\">,</span>\n    newProps<span class=\"token punctuation\">,</span>\n    rootContainerInstance<span class=\"token punctuation\">,</span>\n    currentHostContext<span class=\"token punctuation\">,</span>\n    workInProgress</span>\n  <span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> element <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">createElement</span><span class=\"token punctuation\">(</span>type<span class=\"token punctuation\">)</span>\n    element<span class=\"token punctuation\">.</span>className <span class=\"token operator\">=</span> newProps<span class=\"token punctuation\">.</span>className <span class=\"token operator\">||</span> <span class=\"token string\">''</span>\n    element<span class=\"token punctuation\">.</span>style <span class=\"token operator\">=</span> newProps<span class=\"token punctuation\">.</span>style\n    <span class=\"token comment\">// ....</span>\n    <span class=\"token comment\">// ....</span>\n    <span class=\"token comment\">// if (newProps.onClick) {</span>\n    <span class=\"token comment\">//   element.addEventListener('click', newProps.onClick)</span>\n    <span class=\"token comment\">// }</span>\n    <span class=\"token keyword\">return</span> element\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token function-variable function\">appendInitialChild</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">parent<span class=\"token punctuation\">,</span> child</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    parent<span class=\"token punctuation\">.</span><span class=\"token function\">appendChild</span><span class=\"token punctuation\">(</span>child<span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token function-variable function\">finalizeInitialChildren</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token parameter\">instance<span class=\"token punctuation\">,</span>\n    type<span class=\"token punctuation\">,</span>\n    newProps<span class=\"token punctuation\">,</span>\n    rootContainerInstance<span class=\"token punctuation\">,</span>\n    currentHostContext</span>\n  <span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> newProps<span class=\"token punctuation\">.</span>autofocus <span class=\"token comment\">//simply return true for experimenting</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token function-variable function\">prepareForCommit</span><span class=\"token punctuation\">:</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">rootContainerInstance</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token function-variable function\">resetAfterCommit</span><span class=\"token punctuation\">:</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">rootContainerInstance</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token function-variable function\">commitMount</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">domElement<span class=\"token punctuation\">,</span> type<span class=\"token punctuation\">,</span> newProps<span class=\"token punctuation\">,</span> fiberNode</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    domElement<span class=\"token punctuation\">.</span><span class=\"token function\">focus</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token function-variable function\">appendChildToContainer</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">parent<span class=\"token punctuation\">,</span> child</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    parent<span class=\"token punctuation\">.</span><span class=\"token function\">appendChild</span><span class=\"token punctuation\">(</span>child<span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  supportsMutation<span class=\"token punctuation\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Cool! We have built a tiny renderer that can render JSX to the dom. Next part of the blog post series will focus solely on the update (which is why we use react in the first place üòâ).</p>\n<div style=\"display:flex;flex-direction:row;align-items:center;\">\n    <img src=\"/77f5f7e162d22158b2cd06b8b5469b04/like_a_boss.gif\" alt=\"like a boss\" style=\"height:300px;margin:0 auto;\">\n</div>\n<hr>\n<hr>\n<p>Next part of the blog series will cover the update phase of the renderer after setState is invoked. <a href=\"/react-custom-renderer-3/\">‚öõÔ∏èü§ü Part 3/3 - Beginners guide to Custom React Renderers. How to build your own renderer from scratch?</a></p>\n<hr>\n<hr>\n<h1>References</h1>\n<ul>\n<li><a href=\"https://github.com/facebook/react/tree/master/packages/react-dom\">https://github.com/facebook/react/tree/master/packages/react-dom</a></li>\n<li><a href=\"https://medium.com/@agent_hunt/react-is-also-the-llvm-for-creating-declarative-ui-frameworks-767e75ce1d6a\">https://medium.com/@agent_hunt/react-is-also-the-llvm-for-creating-declarative-ui-frameworks-767e75ce1d6a</a></li>\n<li><a href=\"https://medium.com/@agent_hunt/hello-world-custom-react-renderer-9a95b7cd04bc\">https://medium.com/@agent_hunt/hello-world-custom-react-renderer-9a95b7cd04bc</a></li>\n<li><a href=\"https://github.com/nitin42/Making-a-custom-React-renderer\">https://github.com/nitin42/Making-a-custom-React-renderer</a></li>\n<li><a href=\"https://goshakkk.name/react-custom-renderers/\">https://goshakkk.name/react-custom-renderers/</a></li>\n<li><a href=\"https://hackernoon.com/learn-you-some-custom-react-renderers-aed7164a4199\">https://hackernoon.com/learn-you-some-custom-react-renderers-aed7164a4199</a></li>\n</ul>","frontmatter":{"title":"‚öõÔ∏è‚úåÔ∏è Part 2/3 - Beginners guide to Custom React Renderers. How to build your own renderer from scratch?","date":"October 22, 2018","keywords":"custom, react, renderer, beginners, guide, javascript","featuredImage":{"childImageSharp":null}},"fields":{"slug":"/react-custom-renderer-2/"}}},"pageContext":{"isCreatedByStatefulCreatePages":false,"slug":"/react-custom-renderer-2/","previous":{"fields":{"slug":"/react-custom-renderer-1/"},"frontmatter":{"title":"‚öõÔ∏èüëÜ Part 1/3 - Beginners guide to Custom React Renderers. How to build your own renderer from scratch?"}},"next":{"fields":{"slug":"/react-custom-renderer-3/"},"frontmatter":{"title":"‚öõÔ∏èü§ü Part 3/3 - Beginners guide to Custom React Renderers. How to build your own renderer from scratch?"}}}}}